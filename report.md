## ä¸€ã€å®éªŒç›®çš„

æœ¬å®éªŒè¦æ±‚ä½ ä½¿ç”¨è¯¾ç¨‹æ‰€å­¦çŸ¥è¯†æ‹†é™¤â€œbinary bombsï¼ˆäºŒè¿›åˆ¶ç‚¸å¼¹ï¼Œä¸‹æ–‡å°†ç®€ç§°ä¸ºç‚¸å¼¹ï¼‰â€ï¼Œå¢å¼ºå¯¹ç¨‹åºçš„æœºå™¨çº§è¡¨ç¤ºã€æ±‡ç¼–è¯­è¨€ã€è°ƒè¯•å™¨å’Œé€†å‘å·¥ç¨‹ç­‰æ–¹é¢åŸç†ä¸æŠ€èƒ½çš„æŒæ¡ã€‚ è¿™é‡Œçš„ç‚¸å¼¹æ˜¯ä¸€ä¸ªLinuxå¯æ‰§è¡Œç¨‹åºï¼ŒåŒ…å«äº†6ä¸ªé˜¶æ®µï¼ˆæˆ–å±‚æ¬¡ã€å…³å¡ï¼‰ã€‚ç‚¸å¼¹è¿è¡Œçš„æ¯ä¸ªé˜¶æ®µè¦æ±‚ä½ è¾“å…¥ä¸€ä¸ªç‰¹å®šå­—ç¬¦ä¸²ï¼Œä½ çš„è¾“å…¥ç¬¦åˆç¨‹åºé¢„æœŸçš„è¾“å…¥ï¼Œè¯¥é˜¶æ®µçš„ç‚¸å¼¹å°±è¢«æ‹†é™¤å¼•ä¿¡å³è§£é™¤äº†ï¼Œå¦åˆ™ç‚¸å¼¹â€œçˆ†ç‚¸â€æ‰“å°è¾“å‡º "BOOM!!!"ã€‚å®éªŒçš„ç›®æ ‡æ˜¯æ‹†é™¤å°½å¯èƒ½å¤šçš„ç‚¸å¼¹å…³å¡ã€‚

- é˜¶æ®µ1ï¼šå­—ç¬¦ä¸²æ¯”è¾ƒ
- é˜¶æ®µ2ï¼šå¾ªç¯
- é˜¶æ®µ3ï¼šæ¡ä»¶/åˆ†æ”¯
- é˜¶æ®µ4ï¼šé€’å½’è°ƒç”¨å’Œæ ˆ
- é˜¶æ®µ5ï¼šæŒ‡é’ˆ
- é˜¶æ®µ6ï¼šé“¾è¡¨/æŒ‡é’ˆ/ç»“æ„

å¦å¤–è¿˜æœ‰ä¸€ä¸ªéšè—é˜¶æ®µï¼Œåªæœ‰å½“ä½ åœ¨ç¬¬4é˜¶æ®µçš„è§£åé™„åŠ ä¸€ç‰¹å®šå­—ç¬¦ä¸²åæ‰ä¼šå‡ºç°ã€‚

ä¸ºå®ŒæˆäºŒè¿›åˆ¶ç‚¸å¼¹æ‹†é™¤ä»»åŠ¡ï¼Œä½ éœ€è¦ä½¿ç”¨gdbè°ƒè¯•å™¨å’Œobjdumpæ¥åæ±‡ç¼–ç‚¸å¼¹çš„å¯æ‰§è¡Œæ–‡ä»¶å¹¶è·Ÿè¸ªè°ƒè¯•æ¯ä¸€é˜¶æ®µçš„æœºå™¨ä»£ç ï¼Œä»ä¸­ç†è§£æ¯ä¸€æ±‡
ç¼–è¯­è¨€ä»£ç çš„è¡Œä¸ºæˆ–ä½œç”¨ï¼Œè¿›è€Œè®¾æ³•æ¨æ–­æ‹†é™¤ç‚¸å¼¹æ‰€éœ€çš„ç›®æ ‡å­—ç¬¦ä¸²ã€‚æ¯”å¦‚åœ¨æ¯ä¸€é˜¶æ®µçš„å¼€å§‹ä»£ç å‰å’Œå¼•çˆ†ç‚¸å¼¹çš„å‡½æ•°å‰è®¾ç½®æ–­ç‚¹ã€‚

æœ¬å®éªŒçš„ä»»åŠ¡å°±æ˜¯æ‹†é™¤ç‚¸å¼¹ã€‚ä¸€å®šè¦åœ¨æŒ‡å®šçš„è™šæ‹Ÿæœºä¸Šå®Œæˆä½œä¸šï¼Œåœ¨å…¶ä»–çš„ç¯å¢ƒä¸Šè¿è¡Œæœ‰å¯èƒ½å¯¼è‡´å¤±è´¥ã€‚ï¼ˆé‚£å§‘ä¸”å…ˆè¯•è¯•å’±çš„ Fedora Linux 36ï¼Œè‡³å°‘ï¼Œåœ¨ Fedora 36 å’Œ Windows 10 ä¸‹çš„åæ±‡ç¼–ä»£ç æ˜¯ä¸€è‡´çš„ã€‚ï¼‰

è¦å­¦ä¼šå•æ­¥è·Ÿè¸ªè°ƒè¯•æ±‡ç¼–ä»£ç ä»¥åŠå­¦ä¼šè®¾ç½®æ–­ç‚¹ã€‚ä½ è¿˜è¦å­¦ä¼šå¦‚ä½•æ£€æŸ¥å¯„å­˜å™¨å’Œå†…å­˜çŠ¶æ€ã€‚å¾ˆå¥½çš„ä½¿ç”¨è°ƒè¯•å™¨æ˜¯ä½ åœ¨æœªæ¥çš„èŒä¸šç”Ÿæ¶¯ä¸­èµšåˆ°æ›´å¤šmoneyçš„ä¸€é¡¹é‡è¦æŠ€èƒ½ï¼

## äºŒã€æŠ¥å‘Šè¦æ±‚

æœ¬æŠ¥å‘Šè¦æ±‚å­¦ç”ŸæŠŠå®éªŒä¸­å®ç°çš„æ‰€æœ‰å‡½æ•°é€ä¸€è¿›è¡Œåˆ†æè¯´æ˜ï¼Œå†™å‡ºå®ç°çš„ä¾æ®ï¼Œä¹Ÿå°±æ˜¯æ¨ç†è¿‡ç¨‹ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„æ•°å­¦è¯æ˜ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£ç åˆ†æï¼Œæ ¹æ®å®ç°ä¸­ä½ çš„æƒ³æ³•ä¸åŒè€Œå¼‚ã€‚

## ä¸‰ã€åˆ†æ

### åæ±‡ç¼–

```bash
objdump -d bomb > bomb_disas.txt
```

### phase_1

#### æ­»ç£•ä»£ç 

ä¼ é€’çš„å‚æ•°æ˜¯

```C
char *input;
```

é¦–å…ˆçœ‹åœ¨`main`ä¸­è°ƒç”¨å…¶çš„éƒ¨åˆ†ï¼š

```assembly
  400d6a:	bf 48 23 40 00       	mov    $0x402348,%edi
  400d6f:	e8 6c fd ff ff       	call   400ae0 <puts@plt>
  400d74:	e8 2f 07 00 00       	call   4014a8 <read_line>
  400d79:	48 89 c7             	mov    %rax,%rdi # %rdi å­˜ *inputï¼ˆå­˜çš„å°±æ˜¯æ‰€æŒ‡çš„åœ°å€ï¼‰
  400d7c:	e8 ec 00 00 00       	call   400e6d <phase_1>
  400d81:	e8 50 08 00 00       	call   4015d6 <phase_defused>
```

`phase_1`å‡½æ•°æœ¬ä½“ï¼š

```assembly
0000000000400e6d <phase_1>:
  400e6d:	48 83 ec 08          	sub    $0x8,%rsp
  400e71:	be d0 23 40 00       	mov    $0x4023d0,%esi # åæ¥ä¸€ç›´ç”¨ %rsiï¼Œ%rsi ç›¸å½“äº64ä½æ‰©å®¹å§ã€‚
  400e76:	e8 cf 04 00 00       	call   40134a <strings_not_equal>

  400e7b:	85 c0                	test   %eax,%eax # ANDä¸º0ï¼ŒZFç½®1ï¼Œå¦åˆ™ç½®0ã€‚
  400e7d:	75 05                	jne    400e84 <phase_1+0x17> # ZF=0ï¼Œè·³è½¬ï¼Œçˆ†ã€‚
  400e7f:	48 83 c4 08          	add    $0x8,%rsp # %eax ä¸º0ï¼ŒZF=1ï¼ŒOKã€‚
  400e83:	c3                   	ret    

  400e84:	e8 be 05 00 00       	call   401447 <explode_bomb>
  400e89:	eb f4                	jmp    400e7f <phase_1+0x12>
```

1 Byte = 8 bit

1 ä½ Hex = 4 bit

1 Word = 32/64 bit

å½“`%eax`é 0 æ—¶ä¼šè·³è½¬åˆ°`call   401447 <explode_bomb>`ï¼Œç‚¸äº†ï¼›

éœ€è¦ç»•è¿‡å»ï¼Œä¹Ÿå°±æ˜¯æƒ³æ³•è®©`%eax`ä¸º 0ï¼Œè¿™æ ·ä¹‹åç›´æ¥`ret`ã€‚

ä¹Ÿå°±è¯¥è®© `<strings_not_equal>`è¿”å› 0ï¼Œä¹Ÿå°±å¾—è®©`40136e:	89 d0                	mov    %edx,%eax`ä¸­çš„`%edx`ä¸º 0ã€‚

å…¶è°ƒç”¨çš„`strings_not_equal`ï¼š

```assembly
000000000040134a <strings_not_equal>:
  40134a:	41 54                	push   %r12
  40134c:	55                   	push   %rbp
  40134d:	53                   	push   %rbx
  
  # ç¬¬ä¸€æ¬¡<string_length>
  40134e:	48 89 fb             	mov    %rdi,%rbx # æ¥è‡ª <main> ä¸­çš„ %rdiï¼Œä¹Ÿå°±æ˜¯è¯»å…¥çš„å­—ç¬¦ä¸²çš„åœ°å€
  401351:	48 89 f5             	mov    %rsi,%rbp # æ¥è‡ª <phase_1> ä¸­çš„ %esiï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡å­—ç¬¦ä¸²çš„åœ°å€
  401354:	e8 d4 ff ff ff       	call   40132d <string_length>
  # ç¬¬äºŒæ¬¡<string_length>
  401359:	41 89 c4             	mov    %eax,%r12d # æš‚å­˜ç¬¬ä¸€é <string_length> çš„è¿”å›å€¼
  40135c:	48 89 ef             	mov    %rbp,%rdi # æ‹¿ %rsi æ¥æ›¿ï¼Œå†è°ƒä¸€éã€‚
  40135f:	e8 c9 ff ff ff       	call   40132d <string_length>
  
  401364:	ba 01 00 00 00       	mov    $0x1,%edx # %edx è®¾ä¸º 1ã€‚
  401369:	41 39 c4             	cmp    %eax,%r12d # ä¸¤æ¬¡è°ƒç”¨è¿”å›å€¼ç›¸ç­‰ï¼Œåˆ™ZFç½®1ï¼Œè¿›å¾ªç¯ã€‚
  40136c:	74 07                	je     401375 <strings_not_equal+0x2b>
  
  40136e:	89 d0                	mov    %edx,%eax # è¿”å›å€¼ä¸ç›¸ç­‰ï¼Œé‚£å°±æ˜¯è¿”å›1äº†ï¼Œçˆ†ï¼›æˆ–è€…æ˜¯ä¸‹é¢çš„å¾ªç¯ç»ˆæ­¢ã€‚
  401370:	5b                   	pop    %rbx
  401371:	5d                   	pop    %rbp
  401372:	41 5c                	pop    %r12
  401374:	c3                   	ret    
  
####
#### è¿™æ®µåƒä¸ªå¾ªç¯ã€‚
  401375:	0f b6 03             	movzbl (%rbx),%eax # (%rbx) -> %eax
  401378:	84 c0                	test   %al,%al # %al æ˜¯ %eax çš„ä½ 8 ä½ï¼Œæ­£å¥½å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ã€‚
  40137a:	74 27                	je     4013a3 <strings_not_equal+0x59> # %alä¸º0ï¼Œç¡®å®šè¯»å…¥çš„å½“å‰ä½ç½®ä¸ºNULLï¼ŒOKã€‚

  40137c:	3a 45 00             	cmp    0x0(%rbp),%al # %a1 - (%rbp)ï¼Œæ¯”è¾ƒ
  40137f:	75 29                	jne    4013aa <strings_not_equal+0x60> # ä¸ç­‰ï¼Œå®Œè›‹
  401381:	48 83 c3 01          	add    $0x1,%rbx # æ¥è‡ª <main> ä¸­çš„ %rdi + 1ï¼ŒæŒ‡é’ˆåç§»
  401385:	48 83 c5 01          	add    $0x1,%rbp # æ¥è‡ª <phase_1> ä¸­çš„ %esi +1ï¼ŒæŒ‡é’ˆåç§»
  401389:	0f b6 03             	movzbl (%rbx),%eax # è¿”å› %rbx
  
  40138c:	84 c0                	test   %al,%al # %a1 ä¸º0ï¼ŒZFç½®1ã€‚
  40138e:	74 0c                	je     40139c <strings_not_equal+0x52> # è·³è½¬ï¼Œè¿”å› 0ï¼ŒOKã€‚
  
  401390:	38 45 00             	cmp    %al,0x0(%rbp)
  401393:	74 ec                	je     401381 <strings_not_equal+0x37> # ç›¸ç­‰ï¼Œé›·åŒã€‚
  401395:	ba 01 00 00 00       	mov    $0x1,%edx # %a1!=%rbpï¼Œå®Œè›‹ã€‚
  40139a:	eb d2                	jmp    40136e <strings_not_equal+0x24> # å¼ºåˆ¶æˆªèƒ¡ã€‚
####
####

  40139c:	ba 00 00 00 00       	mov    $0x0,%edx # è¿”å› 0ï¼ŒOKã€‚
  4013a1:	eb cb                	jmp    40136e <strings_not_equal+0x24>
  
  4013a3:	ba 00 00 00 00       	mov    $0x0,%edx # OKã€‚
  4013a8:	eb c4                	jmp    40136e <strings_not_equal+0x24>
  
  4013aa:	ba 01 00 00 00       	mov    $0x1,%edx # å®Œè›‹ã€‚
  4013af:	eb bd                	jmp    40136e <strings_not_equal+0x24>
```

åˆè°ƒç”¨çš„`string_length`ï¼š

```assembly
000000000040132d <string_length>:
  40132d:	80 3f 00             	cmpb   $0x0,(%rdi) # (%rdi) == 0ï¼Œä¹Ÿå°±æ˜¯input[0] == NULLï¼ŒZFç½®1ï¼Œåä¹‹ç½®0ã€‚
  401330:	74 12                	je     401344 <string_length+0x17> # ZF=1ï¼Œè·³è½¬ï¼Œå°† %eax ç½®0ã€‚
  401332:	48 89 fa             	mov    %rdi,%rdx # %rdi -> %rdx
  
  #### ç±»ä¼¼äºä¸€ä¸ªæŒ‡é’ˆå›ºå®šæŒ‡å‘å¤´ï¼Œä¸€ä¸ªæŒ‡å‘å°¾ï¼Œç§»åŠ¨å°¾ç›´åˆ°ç¢°åˆ° NULLã€‚
  401335:	48 83 c2 01          	add    $0x1,%rdx # %rdx ++ï¼ˆinput[++i]ï¼‰
  401339:	89 d0                	mov    %edx,%eax # %eax <- %edxï¼ˆ%rdx æˆªåŠï¼‰
  40133b:	29 f8                	sub    %edi,%eax # %eax -= %ediï¼ˆ%rdi æˆªåŠï¼‰
  
  40133d:	80 3a 00             	cmpb   $0x0,(%rdx) # input[i] ?= 0
  401340:	75 f3                	jne    401335 <string_length+0x8> # (%rdx) != 0ï¼Œå†è¿›è¡Œå‰é¢çš„å¾ªç¯
  401342:	f3 c3                	repz ret # %rdx == 0ï¼Œè¿”å›
  
  401344:	b8 00 00 00 00       	mov    $0x0,%eax
  401349:	c3                   	ret    
```

æ®æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ¤æ–­å…¶æ˜¯å¦ä¸ºç©ºï¼Œ`%rdi`ä¸º 0ï¼ˆç›¸å½“äºæ•°ç»„é¦–ä½ï¼‰çš„è¯å°±æ˜¯ä¸º`NULL`äº†å§ã€‚

ä»è¿™é‡Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä»€ä¹ˆå‰é¢çš„å¾ªç¯éƒ½æ˜¯ ++ å³å¯äº†ï¼Œ`char`æ¯•ç«Ÿæ˜¯åªå äº†1 Byteçš„ï¼Œæˆ‘ä»¬åœ¨éå†æ•°ç»„ä¸­çš„ input[0], input[1] ... æ—¶ï¼Œå½¼æ­¤ä¹‹é—´çš„åœ°å€åªå·®äº† 1ã€‚

å¥½å§ï¼Œå…¶å®æ²¡å¿…è¦å…¨éƒ¨æŠŠä»£ç ææ‡‚çš„â€¦â€¦å®é™…ä¸Šå‰é¢ç†è§£å¤§æ¦‚ä¹Ÿä¸æ€ä¹ˆåˆ°ä½ï¼Œä¹‹åå†ä¿®æ”¹å§ã€‚

#### Objdumpå¦™ç”¨

å‰é¢ç¢ç£¨äº†å¾ˆä¹…ï¼Œä¹Ÿæ²¡æœ‰æƒ³æ˜ç™½`%rsi`é‡Œåˆ°åº•å­˜äº†ä»€ä¹ˆã€‚åæ¥å‘ç°ä¼¼ä¹å€˜è‹¥åªåæ±‡ç¼–â€œexecutable sectionsâ€ï¼Œæ˜¯æ‰¾ä¸åˆ°`$0x4023d0`è¿™ä¸ªåœ°å€çš„ã€‚

å–å·§ä¸€ç‚¹ï¼š

```Bash
  -d, --disassemble        Display assembler contents of executable sections
  -D, --disassemble-all    Display assembler contents of all sections
```

```bash
objdump -D bomb > bomb_disas_all.txt
```

è€ƒè™‘åˆ°`string`åº”ä»¥`NULL`ä¸ºç•Œï¼Œåˆ™ç›´æ¥å¼€è¯»ç›´åˆ°`00`ã€‚

```assembly
  4023cf:	00 53 6c             	add    %dl,0x6c(%rbx)
  4023d2:	61                   	(bad)  
  4023d3:	76 65                	jbe    40243a <_IO_stdin_used+0x1ba>
  4023d5:	2c 20                	sub    $0x20,%al
  4023d7:	74 68                	je     402441 <_IO_stdin_used+0x1c1>
  4023d9:	6f                   	outsl  %ds:(%rsi),(%dx)
  4023da:	75 20                	jne    4023fc <_IO_stdin_used+0x17c>
  4023dc:	68 61 73 74 20       	push   $0x20747361
  4023e1:	73 6c                	jae    40244f <_IO_stdin_used+0x1cf>
  4023e3:	61                   	(bad)  
  4023e4:	69 6e 20 6d 65 2e 20 	imul   $0x202e656d,0x20(%rsi),%ebp
  4023eb:	56                   	push   %rsi
  4023ec:	69 6c 6c 61 69 6e 2c 	imul   $0x202c6e69,0x61(%rsp,%rbp,2),%ebp
  4023f3:	20 
  4023f4:	74 61                	je     402457 <_IO_stdin_used+0x1d7>
  4023f6:	6b 65 20 6d          	imul   $0x6d,0x20(%rbp),%esp
  4023fa:	79 20                	jns    40241c <_IO_stdin_used+0x19c>
  4023fc:	70 75                	jo     402473 <_IO_stdin_used+0x1f3>
  4023fe:	72 73                	jb     402473 <_IO_stdin_used+0x1f3>
  402400:	65 2e 00 00          	gs add %al,%gs:(%rax)
```

æ•´ç‚¹å­ Python ä»£ç ç®€åŒ–æ“ä½œï¼š

```Python
# Given hex values, convert them to their ASCII characters
hex_values = "53 6c 61 76 65 2c 20 74 68 6f 75 20 68 61 73 74 20 73 6c 61 69 6e 20 6d 65 2e 20 56 69 6c 6c 61 69 6e 2c 20 74 61 6b 65 20 6d 79 20 70 75 72 73 65 2e 00"
ascii_string = bytes.fromhex(hex_values).decode('ascii').rstrip('\x00')  # Remove the null terminator at the end for display
ascii_string
```

æŸ¥äº†ä¸‹ï¼Œå‡ºè‡ªã€Šæå°”ç‹ã€‹ï¼š

```c
'Slave, thou hast slain me. Villain, take my purse.'
```

æˆ‘è¯´æ€ä¹ˆå®éªŒæ–‡æ¡£é‡Œç»™çš„ç¤ºä¾‹ä¸æˆ‘ç”Ÿæˆçš„åæ±‡ç¼–ä»£ç ä¸ä¸€æ ·å‘¢ï¼ŒåŸæ¥â€¦â€¦

### phase_2

`phase_2`å‡½æ•°æœ¬ä½“ï¼š

```assembly
0000000000400e8b <phase_2>:
  400e8b:	53                   	push   %rbx
  400e8c:	48 83 ec 20          	sub    $0x20,%rsp # ä¸ºä»€ä¹ˆè…¾äº† 32 Bytes å‡ä½¿æ­¤åœ°å€ä¸º aã€‚
  400e90:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax # æ®µå¯„å­˜å™¨ 2*16+8=40ï¼Ÿ
  400e97:	00 00 
  400e99:	48 89 44 24 18       	mov    %rax,0x18(%rsp) # %rsp + 24(a+24) æŒ‡å‘çš„ä½ç½®æ”¾å…¥äº† %raxï¼Œç•™ç©ºç»™å…­ä¸ªå¯„å­˜å™¨ï¼Ÿ
  400e9e:	31 c0                	xor    %eax,%eax # %eax = 0
  400ea0:	48 89 e6             	mov    %rsp,%rsi # %rsp -> %rsi a
  400ea3:	e8 c1 05 00 00       	call   401469 <read_six_numbers>
  
  400ea8:	83 3c 24 00          	cmpl   $0x0,(%rsp)
  400eac:	78 07                	js     400eb5 <phase_2+0x2a> # (%rsp) < 0 å°±çˆ†ï¼Ÿ
  
  400eae:	bb 01 00 00 00       	mov    $0x1,%ebx # %ebx = 1
  400eb3:	eb 11                	jmp    400ec6 <phase_2+0x3b>
  
  400eb5:	e8 8d 05 00 00       	call   401447 <explode_bomb>
  400eba:	eb f2                	jmp    400eae <phase_2+0x23> # è¿™å¥æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œä¸éƒ½å·²ç»çˆ†äº†å—ï¼Ÿ
  
  400ebc:	48 83 c3 01          	add    $0x1,%rbx
  
  400ec0:	48 83 fb 06          	cmp    $0x6,%rbx
  400ec4:	74 12                	je     400ed8 <phase_2+0x4d> # æ»¡ 6 å›äº†ï¼Œè¿‡å…³ã€‚
  
  400ec6:	89 d8                	mov    %ebx,%eax # %eax = %ebx = 1
  400ec8:	03 44 9c fc          	add    -0x4(%rsp,%rbx,4),%eax # %eax += (%rsp + 4*%rbx - 4)
  400ecc:	39 04 9c             	cmp    %eax,(%rsp,%rbx,4) # (%rsp + %rbx*4) ?= %eax
  400ecf:	74 eb                	je     400ebc <phase_2+0x31> # ç›¸ç­‰åˆ™ç»§ç»­åˆ¤æ–­
  # é€ ä¸€ç»„æ•°æ®ï¼š
  # 0+1=1 1+2=3 3+3=6 6+4=10 10+5=15
  400ed1:	e8 71 05 00 00       	call   401447 <explode_bomb>
  400ed6:	eb e4                	jmp    400ebc <phase_2+0x31>
  400ed8:	48 8b 44 24 18       	mov    0x18(%rsp),%rax # 24 Bytes
  400edd:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  400ee4:	00 00 
  400ee6:	75 06                	jne    400eee <phase_2+0x63> # çˆ†æ ˆ
  400ee8:	48 83 c4 20          	add    $0x20,%rsp
  400eec:	5b                   	pop    %rbx
  400eed:	c3                   	ret    
  400eee:	e8 0d fc ff ff       	call   400b00 <__stack_chk_fail@plt>
```

è°ƒç”¨çš„`read_six_numbers`ï¼š

```assembly
0000000000401469 <read_six_numbers>:
  401469:	48 83 ec 08          	sub    $0x8,%rsp # åˆè…¾äº† 8 Bytes a-8
  40146d:	48 89 f2             	mov    %rsi,%rdx # %rsp->%rsi->%rdx a
  401470:	48 8d 4e 04          	lea    0x4(%rsi),%rcx # a + 4->%rcx åŠ¨çš„åªæ˜¯åœ°å€
  401474:	48 8d 46 14          	lea    0x14(%rsi),%rax # a + 20->%rax
  401478:	50                   	push   %rax # a-8
  401479:	48 8d 46 10          	lea    0x10(%rsi),%rax # a + 16->%rax
  40147d:	50                   	push   %rax # a-4
  40147e:	4c 8d 4e 0c          	lea    0xc(%rsi),%r9 # a + 12->%r9
  401482:	4c 8d 46 08          	lea    0x8(%rsi),%r8 # a + 8->%r8
  401486:	be c3 25 40 00       	mov    $0x4025c3,%esi
  40148b:	b8 00 00 00 00       	mov    $0x0,%eax
  401490:	e8 0b f7 ff ff       	call   400ba0 <__isoc99_sscanf@plt>
  401495:	48 83 c4 10          	add    $0x10,%rsp # %rsp += 16
  401499:	83 f8 05             	cmp    $0x5,%eax
  40149c:	7e 05                	jle    4014a3 <read_six_numbers+0x3a> # %eax <= 5ï¼Œçˆ†ã€‚
  40149e:	48 83 c4 08          	add    $0x8,%rsp # %eax > 5ï¼Œæˆ‘ä»¬å®‰å…¨äº†ï¼Œæš‚æ—¶çš„ã€‚
  4014a2:	c3                   	ret    
  4014a3:	e8 9f ff ff ff       	call   401447 <explode_bomb>
```

å¥½å¥‡`$0x4025c3`åˆ°åº•æ˜¯å“ªå—å„¿ã€‚

```assembly
Disassembly of section .rodata:

0000000000402480 <array.3415>:

  4025c1:	2e 00 25 64 20 25 64 	cs add %ah,0x64252064(%rip)        # 6465462c <_end+0x6405081c>
  4025c8:	20 25 64 20 25 64    	and    %ah,0x64252064(%rip)        # 64654632 <_end+0x64050822>
  4025ce:	20 25 64 20 25 64    	and    %ah,0x64252064(%rip)        # 64654638 <_end+0x64050828>
  4025d4:	00 45 72             	add    %al,0x72(%rbp)
```

Ghidra åˆ†ææ‰€å¾—ï¼š

```assembly
                                 	s_%d_%d_%d_%d_%d_%d_004025c3     
                                    
  004025c3  25 64 20 25 64 20    	ds    "%d %d %d %d %d %d"
            25 64 20 25 64 20 
            25 64 20 25 64 00
```

### phase_3

```assembly
0000000000400ef3 <phase_3>:
  400ef3:	48 83 ec 18          	sub    $0x18,%rsp
  400ef7:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax
  400efe:	00 00 
  400f00:	48 89 44 24 08       	mov    %rax,0x8(%rsp)
  400f05:	31 c0                	xor    %eax,%eax # %eax = 0
  400f07:	48 8d 4c 24 04       	lea    0x4(%rsp),%rcx
  400f0c:	48 89 e2             	mov    %rsp,%rdx
  400f0f:	be cf 25 40 00       	mov    $0x4025cf,%esi # è¯»å…¥ä¸¤ä¸ªæ•´æ•°
  400f14:	e8 87 fc ff ff       	call   400ba0 <__isoc99_sscanf@plt>
  400f19:	83 f8 01             	cmp    $0x1,%eax # æ²¡è¯»å¤Ÿï¼Œçˆ†ã€‚
  400f1c:	7e 10                	jle    400f2e <phase_3+0x3b>
  
  400f1e:	83 3c 24 07          	cmpl   $0x7,(%rsp) # (%rsp) > 7 å‡ºé”™ï¼Œæ€»å…±8ä¸ªåˆ†æ”¯ã€‚
  400f22:	77 42                	ja     400f66 <phase_3+0x73> # jump if aboveï¼Œçˆ†
  
  400f24:	8b 04 24             	mov    (%rsp),%eax
  400f27:	ff 24 c5 40 24 40 00 	jmp    *0x402440(,%rax,8) # M[0x402440 + %rax * 8]
  400f2e:	e8 14 05 00 00       	call   401447 <explode_bomb> # çˆ†
  400f33:	eb e9                	jmp    400f1e <phase_3+0x2b> # ä»ä¸ç†è§£

#### Cases
# ä»¥ä¸‹å…¨éƒ½æ˜¯è·³åˆ°400f77
  400f35:	b8 35 02 00 00       	mov    $0x235,%eax
  400f3a:	eb 3b                	jmp    400f77 <phase_3+0x84>
  
  400f3c:	b8 a7 01 00 00       	mov    $0x1a7,%eax
  400f41:	eb 34                	jmp    400f77 <phase_3+0x84>
  
  400f43:	b8 2b 02 00 00       	mov    $0x22b,%eax
  400f48:	eb 2d                	jmp    400f77 <phase_3+0x84>
  
  400f4a:	b8 6c 00 00 00       	mov    $0x6c,%eax
  400f4f:	eb 26                	jmp    400f77 <phase_3+0x84>
  
  400f51:	b8 f1 02 00 00       	mov    $0x2f1,%eax
  400f56:	eb 1f                	jmp    400f77 <phase_3+0x84>
  
  400f58:	b8 3e 00 00 00       	mov    $0x3e,%eax
  400f5d:	eb 18                	jmp    400f77 <phase_3+0x84>
  
  400f5f:	b8 48 02 00 00       	mov    $0x248,%eax
  400f64:	eb 11                	jmp    400f77 <phase_3+0x84>
####

  400f66:	e8 dc 04 00 00       	call   401447 <explode_bomb> # çˆ†ï¼Œä¹‹å‰ä¼¼ä¹å¯¹çˆ†ç‚¸æœºåˆ¶æœ‰æ‰€è¯¯è§£ã€‚
  
  400f6b:	b8 00 00 00 00       	mov    $0x0,%eax
  400f70:	eb 05                	jmp    400f77 <phase_3+0x84>
  
# Case
  400f72:	b8 21 01 00 00       	mov    $0x121,%eax
  400f77:	39 44 24 04          	cmp    %eax,0x4(%rsp) # (%rsp+4) ?= %eax ç¬¬äºŒä¸ªæ•°è¦ä¸ç¬¬ä¸€ä¸ªæ•°è·³è½¬çš„åˆ†æ”¯é‡Œçš„æ•°å¯¹åº”
# æ„é€ æ•°æ®ï¼š
# 0 -> 400f72
# 1*256+2*16+1 = 256+32+1 = 289
# 0 289
  400f7b:	74 05                	je     400f82 <phase_3+0x8f> # è¦é¡ºåˆ©ç»“æŸã€‚
  400f7d:	e8 c5 04 00 00       	call   401447 <explode_bomb> # çˆ†
  
  400f82:	48 8b 44 24 08       	mov    0x8(%rsp),%rax
  400f87:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  400f8e:	00 00 
  400f90:	75 05                	jne    400f97 <phase_3+0xa4> # çˆ†æ ˆ
  400f92:	48 83 c4 18          	add    $0x18,%rsp
  400f96:	c3                   	ret    
  400f97:	e8 64 fb ff ff       	call   400b00 <__stack_chk_fail@plt>
```

`$0x4025cf`æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢

```assembly
  00400f0f be  cf  25       MOV        ESI ,s_%d_%d_004025c3+12                         = "%d %d"
           40  00
```

å­˜æ”¾ç€å¯¹åº”çš„å„ä¸ªæ ‡ç­¾ã€‚

é¡ºå¸¦ï¼Œè¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥é‡‡ç”¨çš„æ˜¯å°ç«¯åºã€‚

```assembly
                         switchD_00400f27::switchdataD_00402440          
                         
    00402440 72  0f  40       addr       switchD_00400f27::caseD_0
             00  00  00 
             00  00
    00402448 35  0f  40       addr       switchD_00400f27::caseD_1
             00  00  00 
             00  00
    00402450 3c  0f  40       addr       switchD_00400f27::caseD_2
             00  00  00 
             00  00
    00402458 43  0f  40       addr       switchD_00400f27::caseD_3
             00  00  00 
             00  00
    00402460 4a  0f  40       addr       switchD_00400f27::caseD_4
             00  00  00 
             00  00
    00402468 51  0f  40       addr       switchD_00400f27::caseD_5
             00  00  00 
             00  00
    00402470 58  0f  40       addr       switchD_00400f27::caseD_6
             00  00  00 
             00  00
    00402478 5f  0f  40       addr       switchD_00400f27::caseD_7
             00  00  00 
             00  00
```

### phase_4

```assembly
0000000000400fdb <phase_4>:
  400fdb:	48 83 ec 18          	sub    $0x18,%rsp
  400fdf:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax
  400fe6:	00 00 
  400fe8:	48 89 44 24 08       	mov    %rax,0x8(%rsp)
  400fed:	31 c0                	xor    %eax,%eax # %eax = 0
  400fef:	48 8d 4c 24 04       	lea    0x4(%rsp),%rcx # ç¬¬äºŒä¸ªè¾“å…¥
  400ff4:	48 89 e2             	mov    %rsp,%rdx # åº”è¯¥æ˜¯å­˜ç¬¬ä¸€ä¸ªè¾“å…¥å§
  400ff7:	be cf 25 40 00       	mov    $0x4025cf,%esi # è¯»å…¥ä¸¤ä¸ªæ•´æ•°
  400ffc:	e8 9f fb ff ff       	call   400ba0 <__isoc99_sscanf@plt>
  401001:	83 f8 02             	cmp    $0x2,%eax
  401004:	75 06                	jne    40100c <phase_4+0x31> # æ•°é‡ä¸å¯¹ï¼Œçˆ†
  
  401006:	83 3c 24 0e          	cmpl   $0xe,(%rsp) # (%rsp) > e ä¼šçˆ†ã€‚
  40100a:	76 05                	jbe    401011 <phase_4+0x36> # jbe for unsigned, jle for signed
  40100c:	e8 36 04 00 00       	call   401447 <explode_bomb>
  
# %edx a_1 = 14
# %esi a_2 = 0
# %edi a_3 = input_1
  401011:	ba 0e 00 00 00       	mov    $0xe,%edx # %edx = e = 14
  401016:	be 00 00 00 00       	mov    $0x0,%esi # %esi = 0
  40101b:	8b 3c 24             	mov    (%rsp),%edi # %edi = (%rsp)
  40101e:	e8 79 ff ff ff       	call   400f9c <func4>
  401023:	83 f8 03             	cmp    $0x3,%eax # %eax != 3 å°±çˆ†ç‚¸ã€‚
  # ç¬¬ä¸€ä¸ªè¾“å…¥åº”å½“ä¸º 13
  401026:	75 07                	jne    40102f <phase_4+0x54>
  
  401028:	83 7c 24 04 03       	cmpl   $0x3,0x4(%rsp) # (%rsp+4) != 3 å°±çˆ†ç‚¸
  # ç¬¬äºŒä¸ªè¾“å…¥åº”å½“ä¸º 3
  40102d:	74 05                	je     401034 <phase_4+0x59>
  40102f:	e8 13 04 00 00       	call   401447 <explode_bomb>
  
  401034:	48 8b 44 24 08       	mov    0x8(%rsp),%rax
  401039:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  401040:	00 00 
  401042:	75 05                	jne    401049 <phase_4+0x6e>
  401044:	48 83 c4 18          	add    $0x18,%rsp
  401048:	c3                   	ret    
  401049:	e8 b2 fa ff ff       	call   400b00 <__stack_chk_fail@plt>
```

`func4`ï¼š

```assembly
# %edx a_1
# %esi a_2
# %edi a_3
0000000000400f9c <func4>:
  400f9c:	48 83 ec 08          	sub    $0x8,%rsp
  400fa0:	89 d0                	mov    %edx,%eax # %eax = a_1
  400fa2:	29 f0                	sub    %esi,%eax # %eax = a_1 - a_2
  400fa4:	89 c1                	mov    %eax,%ecx # %ecx = a_1 - a_2
  400fa6:	c1 e9 1f             	shr    $0x1f,%ecx # %ecx é€»è¾‘å³ç§»31ä½ï¼Œä¿ç•™æœ€é«˜ä½ã€‚ï¼ˆ0 æˆ– 1ï¼‰ ç§»åŠ¨äº†ä¸ªå¯‚å¯ï¼Œå‡ ä¹ä¸€å®šä¸º 0ã€‚a_1 - a_2 éƒ½ä¸å¤ªå¯èƒ½è¿™ä¹ˆå¤§ã€‚
  400fa9:	01 c1                	add    %eax,%ecx # %ecx = (a_1 - a_2) >>logi 31 +  (a_1 - a_2)
  400fab:	d1 f9                	sar    %ecx # %ecx ç¬¦å·å³ç§»1ä½ = [(a_1 - a_2) >>logi 31 +  (a_1 - a_2)]/2
  400fad:	01 f1                	add    %esi,%ecx # %ecx = [(a_1 - a_2) >>logi 31 +  (a_1 - a_2)]/2 + a_2
                 	               	               	 # åŒ–ç®€ä¸€ä¸‹ %ecx = (a_1 - a_2)]/2 + a_2
                 	               	               	 # å–ä¸­ç‚¹
  400faf:	39 f9                	cmp    %edi,%ecx # %ecx ?= a_3
  400fb1:	7f 0e                	jg     400fc1 <func4+0x25> # %ecx > a_3
  
  400fb3:	b8 00 00 00 00       	mov    $0x0,%eax # %eax = 0
  400fb8:	39 f9                	cmp    %edi,%ecx # %ecx ?= %edi
  400fba:	7c 11                	jl     400fcd <func4+0x31> # %ecx < a_3
  400fbc:	48 83 c4 08          	add    $0x8,%rsp
  400fc0:	c3                   	ret    
####
# a_2 ... ... ... %rcx ... .a_3. ... a_1
# a_1 = 14; a_2 = 0; a_3 = input_1
  #!!! %rcx å°±æ˜¯ %ecx
  # %ecx > a_3
  # ä¸­ç‚¹æ¯” a_3 å¤§ï¼Œé‚£å°±å°†å³ç«¯ç‚¹æ”¹ä¸ºä¸­ç‚¹å¾€å·¦ä¸€ç‚¹ã€‚
  400fc1:	8d 51 ff             	lea    -0x1(%rcx),%edx # a_1 = %rcx - 1
  400fc4:	e8 d3 ff ff ff       	call   400f9c <func4>
  400fc9:	01 c0                	add    %eax,%eax # %eax *= 2
  400fcb:	eb ef                	jmp    400fbc <func4+0x20> # é¡ºåˆ©
  
  # %eax = 0
  # %ecx < a_3
  # ä¸­ç‚¹æ¯” a_3 å°ï¼Œé‚£å°±å°†å·¦ç«¯ç‚¹æ”¹ä¸ºä¸­ç‚¹å¾€å³ä¸€ç‚¹ã€‚
  400fcd:	8d 71 01             	lea    0x1(%rcx),%esi # %a_2 = %rcx + 1
  # é‚£ä¹ˆè¿™é‡Œè¿›è¡Œçš„æ˜¯ a_1 = 14; a_2 = 8; a_3 = 11; è¿™æ ·çš„è¯ï¼Œåªä¼šå¾—åˆ° 1ã€‚
  #                a_1 = 14; a_2 = 12; a_3 = 13;
  400fd0:	e8 c7 ff ff ff       	call   400f9c <func4>
  
  # 3=2*1+1 1=2*0+1
  400fd5:	8d 44 00 01          	lea    0x1(%rax,%rax,1),%eax # %eax = 2*%rax+1
  400fd9:	eb e1                	jmp    400fbc <func4+0x20> # é¡ºåˆ©
```

### secret_phase ğŸš§

â€œåªæœ‰å½“ä½ åœ¨ç¬¬4é˜¶æ®µçš„è§£åé™„åŠ ä¸€ç‰¹å®šå­—ç¬¦ä¸²åâ€ # æ€»è§‰å¾—è¿™è¯åœ¨è¯“æˆ‘

åˆ°åº•åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹æ‰è§¦å‘äº†å‘¢ï¼Ÿ

`secret_phase`å‡½æ•°æœ¬ä½“

```assembly
000000000040125f <secret_phase>:
  40125f:	53                   	push   %rbx
  401260:	e8 43 02 00 00       	call   4014a8 <read_line> # å†è¯»å…¥è¡Œï¼Œæ‰€ä»¥è¯¥é—®è¾“å…¥åº”è¯¥å¾—æ¢è¡Œå§
# %edx a_1 = 10
# %esi a_2 = 0
# %edi a_3 = *input
  401265:	ba 0a 00 00 00       	mov    $0xa,%edx
  40126a:	be 00 00 00 00       	mov    $0x0,%esi
  40126f:	48 89 c7             	mov    %rax,%rdi
  401272:	e8 09 f9 ff ff       	call   400b80 <strtol@plt>
# %rbx = (int) input
# %eax = (int) input - 1
  401277:	48 89 c3             	mov    %rax,%rbx
  40127a:	8d 40 ff             	lea    -0x1(%rax),%eax
# (int) input - 1 ?= 1000
  40127d:	3d e8 03 00 00       	cmp    $0x3e8,%eax # 3*256+14*16+8 = 1000
  401282:	77 27                	ja     4012ab <secret_phase+0x4c> # è¶…è¿‡1000ç›´æ¥çˆ†ç‚¸ã€‚
# a_2 = (int) input
# a_3 = $0x6030f0 ??? åƒæ˜¯æ•°ç»„åŸºå€ã€‚
  401284:	89 de                	mov    %ebx,%esi
  401286:	bf f0 30 60 00       	mov    $0x6030f0,%edi
  40128b:	e8 90 ff ff ff       	call   401220 <fun7>
  401290:	83 f8 04             	cmp    $0x4,%eax
  401293:	74 05                	je     40129a <secret_phase+0x3b>
  401295:	e8 ad 01 00 00       	call   401447 <explode_bomb> # ä¸ç­‰äº 4 ç›´æ¥çˆ†ç‚¸
# æ‰€ä»¥è¦å‡‘å‡ºæ¥ %eax = 4
# éœ€è¦ç­‰äº 40ï¼Œä½†æ˜¯ï¼Œå¦‚ä½•è§¦å‘ï¼Ÿ
  40129a:	bf 08 24 40 00       	mov    $0x402408,%edi # "Wow! You've defused the secret stag
  40129f:	e8 3c f8 ff ff       	call   400ae0 <puts@plt>
  4012a4:	e8 2d 03 00 00       	call   4015d6 <phase_defused>
  4012a9:	5b                   	pop    %rbx
  4012aa:	c3                   	ret    
  4012ab:	e8 97 01 00 00       	call   401447 <explode_bomb>
  4012b0:	eb d2                	jmp    401284 <secret_phase+0x25>
```

`secret_phase`åªåœ¨`phase_defused`ä¸­è¢«è°ƒç”¨ï¼š

```assembly
00000000004015d6 <phase_defused>:
  4015d6:	48 83 ec 78          	sub    $0x78,%rsp
  4015da:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax
  4015e1:	00 00 
  4015e3:	48 89 44 24 68       	mov    %rax,0x68(%rsp)
  4015e8:	31 c0                	xor    %eax,%eax
  4015ea:	83 3d 7b 21 20 00 06 	cmpl   $0x6,0x20217b(%rip)        # 60376c <num_input_strings>
  # ä¼¼ä¹å¾—ç ”ç©¶ç ”ç©¶<read_line>
  # æ˜¯ä¸æ˜¯åœ¨æ£€æµ‹ä¸‹ä¸€æ¡æŒ‡ä»¤çš„å¯¹åº”ä½ç½®ï¼Ÿ
  4015f1:	74 15                	je     401608 <phase_defused+0x32>
  
  4015f3:	48 8b 44 24 68       	mov    0x68(%rsp),%rax
  4015f8:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  4015ff:	00 00 
  401601:	75 67                	jne    40166a <phase_defused+0x94>
  401603:	48 83 c4 78          	add    $0x78,%rsp
  401607:	c3                   	ret    
  
  # è¿™é‡Œå‰é¢å¹¶æ²¡æœ‰<read_line>ï¼Œéš¾é“ï¼Œå…¶å®åœ¨ï¼ˆç‰¹å®šä½ç½®ï¼‰è¯»å…¥çš„æ—¶å€™å°±å·²ç»å¼€å§‹æŠ˜è…¾è¿™é‡Œçš„äº†ï¼Ÿ
  # æ­£å¥½<phrase_4>é‡Œå¤´æ¥æ”¶2ä¸ªè¾“å…¥ï¼Œè¿™é‡Œç®—æ˜¯æ¥ç»­ï¼Ÿåº”è¯¥ä¸ç”¨æ¢è¡Œ
  401608:	4c 8d 44 24 10       	lea    0x10(%rsp),%r8 # 16 è¿™ä¸ªåº”è¯¥æ˜¯å­—ç¬¦ä¸²çš„å¼€å¤´å§
  40160d:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx # 12
  401612:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx # 8 è¿™ä¸¤ä¸ªæ•´æ•°ä¸çŸ¥é“ä»€ä¹ˆç”¨å¤„
  401617:	be 19 26 40 00       	mov    $0x402619,%esi # s_%d_%d_%s_00402619
  40161c:	bf 70 38 60 00       	mov    $0x603870,%edi # input_strings[240]
  401621:	e8 7a f5 ff ff       	call   400ba0 <__isoc99_sscanf@plt>
  401626:	83 f8 03             	cmp    $0x3,%eax # è¯»å…¥äº†3ä¸ªä¸œè¥¿
  401629:	74 0c                	je     401637 <phase_defused+0x61>
  
  40162b:	bf 58 25 40 00       	mov    $0x402558,%edi # "Congratulations! You've defused the bomb!"
  401630:	e8 ab f4 ff ff       	call   400ae0 <puts@plt>
  401635:	eb bc                	jmp    4015f3 <phase_defused+0x1d>
  
  401637:	be 22 26 40 00       	mov    $0x402622,%esi # s_urxvt_00402622 "urxvt"
  40163c:	48 8d 7c 24 10       	lea    0x10(%rsp),%rdi # æ¥ä¸‹æ¥å¥½æ¯”è¾ƒå­—ç¬¦ä¸²ã€‚
  401641:	e8 04 fd ff ff       	call   40134a <strings_not_equal>
  401646:	85 c0                	test   %eax,%eax
  401648:	75 e1                	jne    40162b <phase_defused+0x55> # ä¸ç›¸ç­‰ï¼Œå¯„ã€‚
  40164a:	bf f8 24 40 00       	mov    $0x4024f8,%edi # s_Curses,_you've_found_the_secret_p_004024f8
  40164f:	e8 8c f4 ff ff       	call   400ae0 <puts@plt>
  401654:	bf 20 25 40 00       	mov    $0x402520,%edi # s_But_finding_it_and_solving_it_ar_00402520
  401659:	e8 82 f4 ff ff       	call   400ae0 <puts@plt>
  40165e:	b8 00 00 00 00       	mov    $0x0,%eax
  401663:	e8 f7 fb ff ff       	call   40125f <secret_phase>
  401668:	eb c1                	jmp    40162b <phase_defused+0x55>
  40166a:	e8 91 f4 ff ff       	call   400b00 <__stack_chk_fail@plt>
```

`fun7`

```assembly
0000000000401220 <fun7>:
# %edx a_1
# %esi a_2
# %edi a_3
  401220:	48 85 ff             	test   %rdi,%rdi # %rdi ä¸º 0 åˆ™çˆ†ç‚¸ã€‚
  401223:	74 34                	je     401259 <fun7+0x39>
  401225:	48 83 ec 08          	sub    $0x8,%rsp
# a_1 = (a_3) = 0x24 = 32+4= 36
# a_2 è‚¯å®šä¸èƒ½ä¸Šæ¥å°±ç­‰äº 36
# åº”è¯¥æœ‰ a_1 <= a_2ï¼Œè¿™æ ·æ‰èƒ½å…ˆèµ‹0ï¼Œå†åŠ 1ï¼Œä¹‹åå†ä¹˜2ï¼Œå†ä¹˜2ã€‚
# a_2 åº”è¯¥æ˜¯ç­‰äº 40ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š
# a_1 < a_2 = 40
# a_3' = (a_3 + 16), (a_3') = 50, %eax = 1
# a_1' = (a_3') > a_2 = 40
# a_3'' = (a_3' + 8), (a_3'') = 45, %eax = 2
# a_1'' = (a_3'') > a_2 = 40
# a_3''' = (a_3'' + 8), (a_3''') = 40, %eax = 4
# æ‰€æŒ‡å‘çš„å†…å®¹å…¶å®åˆæ˜¯ç‰¹å®šæ•°ç»„çš„åŸºå€
# a_1 ?= a_2
  401229:	8b 17                	mov    (%rdi),%edx
  40122b:	39 f2                	cmp    %esi,%edx
  40122d:	7f 0e                	jg     40123d <fun7+0x1d>
# a_1 <= a_2
  40122f:	b8 00 00 00 00       	mov    $0x0,%eax # %eax = 0
  401234:	39 f2                	cmp    %esi,%edx # a_1 ?= a_2
  401236:	75 12                	jne    40124a <fun7+0x2a>
# a_1 == a_2
  401238:	48 83 c4 08          	add    $0x8,%rsp
  40123c:	c3                   	ret    
  
# a_1 > a_2
  40123d:	48 8b 7f 08          	mov    0x8(%rdi),%rdi # a_3 = (a_3 + 8)
  # a_3 = $0x6030f0 -> (a_3 + 8) = 00603110ã€8ã€‘
  # (a_3 + 8) = 00603110 -> ((a_3 + 8) + 8) =  00603190ã€6ã€‘
  # (a_3 + 8) = 00603110 -> ((a_3 + 8) + 16) =  00603150ã€0x16=22ã€‘
  401241:	e8 da ff ff ff       	call   401220 <fun7>
  401246:	01 c0                	add    %eax,%eax # è°ƒç”¨å®Œè‡ªèº«ï¼Œ%eax *= 2
# å‡ºå¶æ•°ï¼Œåº”è¯¥æ˜¯å¾—ä»è¿™å§ã€‚
  401248:	eb ee                	jmp    401238 <fun7+0x18> # è¿”å›ã€‚
  
# æˆ‘ä»¬åº”è¯¥æ˜¯éœ€è¦è¿™æ ·çš„åœ°å€ï¼š(((a_3 + 16) + 8) + 8)
# a_1 < a_2
  40124a:	48 8b 7f 10          	mov    0x10(%rdi),%rdi # a_3 = (a_3 + 16)
  # a_3 = $0x6030f0 -> (a_3 + 16) = 00603130ã€0x32=48+2=50ã€‘
  # (a_3 + 16) = 00603110 -> ((a_3 + 16) + 8) =  00603170ã€0x2d=32+13=45ã€‘
  # (a_3 + 16) = 00603110 -> ((a_3 + 16) + 16) =  006031b0ã€0x6b=96+11=107ã€‘
  # ((a_3 + 16) + 8) =  00603170 ->  (((a_3 + 16) + 8) + 8) = 006031d0ã€0x28=32+8=40ã€‘
  40124e:	e8 cd ff ff ff       	call   401220 <fun7>
  401253:	8d 44 00 01          	lea    0x1(%rax,%rax,1),%eax # è°ƒç”¨å®Œè‡ªèº«ï¼Œ%eax = 2*%rax+1
  401257:	eb df                	jmp    401238 <fun7+0x18>
  
# çˆ†  
  401259:	b8 ff ff ff ff       	mov    $0xffffffff,%eax
  40125e:	c3                   	ret    
```

è®©æˆ‘ä»¬çœ‹çœ‹`$0x6030f0`é‡Œå¤´æ”¾çš„ä»€ä¹ˆï¼š

```assembly
                             n1
                                                                                          secret_phase:00401286 (*)   
  006030f0 24  00  00       undefine
           00  00  00 
           00  00  10 
  006030f0 24              undefine  24h                     [0]
                                                                                                                     secret_phase:00401286 (*)   
  006030f1 00              undefine  00h                     [1]
  006030f2 00              undefine  00h                     [2]
  006030f3 00              undefine  00h                     [3]
  006030f4 00              undefine  00h                     [4]
  006030f5 00              undefine  00h                     [5]
  006030f6 00              undefine  00h                     [6]
  006030f7 00              undefine  00h                     [7]
  # å°ç«¯åºï¼Œ(a_3 + 8) = 0x603110
  006030f8 10              undefine  10h                     [8]           ?  ->  00603110
  006030f9 31              undefine  31h                     [9]
  006030fa 60              undefine  60h                     [10]
  006030fb 00              undefine  00h                     [11]
  006030fc 00              undefine  00h                     [12]
  006030fd 00              undefine  00h                     [13]
  006030fe 00              undefine  00h                     [14]
  006030ff 00              undefine  00h                     [15]
  # (a_3 + 16) = 0x603130
  00603100 30              undefine  30h                     [16]          ?  ->  00603130
  00603101 31              undefine  31h                     [17]
  00603102 60              undefine  60h                     [18]
  00603103 00              undefine  00h                     [19]
  00603104 00              undefine  00h                     [20]
  00603105 00              undefine  00h                     [21]
  00603106 00              undefine  00h                     [22]
  00603107 00              undefine  00h                     [23]

```

å…¶ä»–çš„å‡ ä¸ªéœ€è¦è¯»çš„æ•°ç»„ä¹Ÿéƒ½æ˜¯è¿™ä¸ªæ ·å­ã€‚

è¿™é‡Œå¤šæ¬¡å‡ºç°äº†`<num_input_strings>`ï¼Œä½†æ˜¯`<num_input_strings>`åˆ°åº•æ˜¯å¦‚ä½•è‡ªå¢çš„ã€‚

```assembly
00000000004014a8 <read_line>:
  4014a8:	48 83 ec 08          	sub    $0x8,%rsp
  4014ac:	b8 00 00 00 00       	mov    $0x0,%eax
  4014b1:	e8 50 ff ff ff       	call   401406 <skip>
  4014b6:	48 85 c0             	test   %rax,%rax
  4014b9:	74 63                	je     40151e <read_line+0x76>
  4014bb:	8b 35 ab 22 20 00    	mov    0x2022ab(%rip),%esi        # 60376c <num_input_strings>
  4014c1:	48 63 c6             	movslq %esi,%rax
  4014c4:	48 8d 14 80          	lea    (%rax,%rax,4),%rdx
  4014c8:	48 c1 e2 04          	shl    $0x4,%rdx
  4014cc:	48 81 c2 80 37 60 00 	add    $0x603780,%rdx
  4014d3:	48 c7 c1 ff ff ff ff 	mov    $0xffffffffffffffff,%rcx
  4014da:	b8 00 00 00 00       	mov    $0x0,%eax
  4014df:	48 89 d7             	mov    %rdx,%rdi
  4014e2:	f2 ae                	repnz scas %es:(%rdi),%al
  4014e4:	48 f7 d1             	not    %rcx
  4014e7:	48 83 e9 01          	sub    $0x1,%rcx
  4014eb:	83 f9 4e             	cmp    $0x4e,%ecx
  4014ee:	0f 8f 9c 00 00 00    	jg     401590 <read_line+0xe8>
  4014f4:	83 e9 01             	sub    $0x1,%ecx
  4014f7:	48 63 c9             	movslq %ecx,%rcx
  4014fa:	48 63 c6             	movslq %esi,%rax
  4014fd:	48 8d 04 80          	lea    (%rax,%rax,4),%rax
  401501:	48 c1 e0 04          	shl    $0x4,%rax
  401505:	c6 84 01 80 37 60 00 	movb   $0x0,0x603780(%rcx,%rax,1)
  40150c:	00 
  40150d:	8d 46 01             	lea    0x1(%rsi),%eax
  401510:	89 05 56 22 20 00    	mov    %eax,0x202256(%rip)        # 60376c <num_input_strings>
  401516:	48 89 d0             	mov    %rdx,%rax
  401519:	48 83 c4 08          	add    $0x8,%rsp
  40151d:	c3                   	ret    
  40151e:	48 8b 05 2b 22 20 00 	mov    0x20222b(%rip),%rax        # 603750 <stdin@@GLIBC_2.2.5>
  401525:	48 39 05 44 22 20 00 	cmp    %rax,0x202244(%rip)        # 603770 <infile>
  40152c:	74 19                	je     401547 <read_line+0x9f>
  40152e:	bf f3 25 40 00       	mov    $0x4025f3,%edi
  401533:	e8 78 f5 ff ff       	call   400ab0 <getenv@plt>
  401538:	48 85 c0             	test   %rax,%rax
  40153b:	74 1e                	je     40155b <read_line+0xb3>
  40153d:	bf 00 00 00 00       	mov    $0x0,%edi
  401542:	e8 89 f6 ff ff       	call   400bd0 <exit@plt>
  401547:	bf d5 25 40 00       	mov    $0x4025d5,%edi
  40154c:	e8 8f f5 ff ff       	call   400ae0 <puts@plt>
  401551:	bf 08 00 00 00       	mov    $0x8,%edi
  401556:	e8 75 f6 ff ff       	call   400bd0 <exit@plt>
  40155b:	48 8b 05 ee 21 20 00 	mov    0x2021ee(%rip),%rax        # 603750 <stdin@@GLIBC_2.2.5>
  401562:	48 89 05 07 22 20 00 	mov    %rax,0x202207(%rip)        # 603770 <infile>
  401569:	b8 00 00 00 00       	mov    $0x0,%eax
  40156e:	e8 93 fe ff ff       	call   401406 <skip>
  401573:	48 85 c0             	test   %rax,%rax
  401576:	0f 85 3f ff ff ff    	jne    4014bb <read_line+0x13>
  40157c:	bf d5 25 40 00       	mov    $0x4025d5,%edi
  401581:	e8 5a f5 ff ff       	call   400ae0 <puts@plt>
  401586:	bf 00 00 00 00       	mov    $0x0,%edi
  40158b:	e8 40 f6 ff ff       	call   400bd0 <exit@plt>
  401590:	bf fe 25 40 00       	mov    $0x4025fe,%edi
  401595:	e8 46 f5 ff ff       	call   400ae0 <puts@plt>
  40159a:	8b 05 cc 21 20 00    	mov    0x2021cc(%rip),%eax        # 60376c <num_input_strings>
  4015a0:	8d 50 01             	lea    0x1(%rax),%edx
  4015a3:	89 15 c3 21 20 00    	mov    %edx,0x2021c3(%rip)        # 60376c <num_input_strings>
  4015a9:	48 98                	cltq   
  4015ab:	48 6b c0 50          	imul   $0x50,%rax,%rax
  4015af:	48 be 2a 2a 2a 74 72 	movabs $0x636e7572742a2a2a,%rsi
  4015b6:	75 6e 63 
  4015b9:	48 bf 61 74 65 64 2a 	movabs $0x2a2a2a64657461,%rdi
  4015c0:	2a 2a 00 
  4015c3:	48 89 b0 80 37 60 00 	mov    %rsi,0x603780(%rax)
  4015ca:	48 89 b8 88 37 60 00 	mov    %rdi,0x603788(%rax)
  4015d1:	e8 71 fe ff ff       	call   401447 <explode_bomb>
```

### phase_5

`phase_5` å‡½æ•°ï¼š

```assembly
000000000040104e <phase_5>:
  40104e:	48 83 ec 18          	sub    $0x18,%rsp
  401052:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax
  401059:	00 00 
  40105b:	48 89 44 24 08       	mov    %rax,0x8(%rsp)
  401060:	31 c0                	xor    %eax,%eax
  401062:	48 8d 4c 24 04       	lea    0x4(%rsp),%rcx
  401067:	48 89 e2             	mov    %rsp,%rdx
  40106a:	be cf 25 40 00       	mov    $0x4025cf,%esi # ä¸ phase_3 ä¸€æ ·
  40106f:	e8 2c fb ff ff       	call   400ba0 <__isoc99_sscanf@plt>
  401074:	83 f8 01             	cmp    $0x1,%eax
  401077:	7e 57                	jle    4010d0 <phase_5+0x82> # %eax <= 1ï¼Œçˆ†
  
  401079:	8b 04 24             	mov    (%rsp),%eax # x_1 -> %eax
  40107c:	83 e0 0f             	and    $0xf,%eax # æ©ç ï¼Œä¿ç•™æœ«4ä½ã€‚
  40107f:	89 04 24             	mov    %eax,(%rsp) # å­˜å›å»ã€‚x_1 %= 16
  401082:	83 f8 0f             	cmp    $0xf,%eax # æ¯”è¾ƒ
  401085:	74 2f                	je     4010b6 <phase_5+0x68> # %eax ç­‰äºfï¼Œçˆ†ã€‚
  # %eax < 16
  401087:	b9 00 00 00 00       	mov    $0x0,%ecx # %ecx = 0
  40108c:	ba 00 00 00 00       	mov    $0x0,%edx
  
  
  # åƒå¾ªç¯
  401091:	83 c2 01             	add    $0x1,%edx # %edx += 1
  # ç´¯è®¡ä¸‰æ¬¡
  401094:	48 98                	cltq   # ç¬¦å·æ‹“å±• %eax
  401096:	8b 04 85 80 24 40 00 	mov    0x402480(,%rax,4),%eax # (402480 + 4*%rax) -> %eax
  # å¾€å‰å›æº¯
  # %rax = 6 -> %eax = f
  # %rax = 14 -> %eax = 6
  # %rax = 2 -> %eax = 14
  # æ‰€ä»¥ %rax åˆå€¼ï¼Œå³ (x_1 % 16) == 2
  40109d:	01 c1                	add    %eax,%ecx # %ecx += %eax
  # %ecx = 0 + 14 + 6 + 15 = 35
  ## ä»¥ä¸Šï¼Œå¯ä»¤ x_1 = 2, x_2 = 35ï¼Œå³ä¸ºå¯è¡Œè¾“å…¥
  40109f:	83 f8 0f             	cmp    $0xf,%eax
  4010a2:	75 ed                	jne    401091 <phase_5+0x43> # %eax != f -> å›å»
  # %eax = f
  
  
  4010a4:	c7 04 24 0f 00 00 00 	movl   $0xf,(%rsp) # x_1 = f
  4010ab:	83 fa 03             	cmp    $0x3,%edx
  4010ae:	75 06                	jne    4010b6 <phase_5+0x68> # çˆ†
  # %edx = 3
  4010b0:	39 4c 24 04          	cmp    %ecx,0x4(%rsp)
  4010b4:	74 05                	je     4010bb <phase_5+0x6d>
  4010b6:	e8 8c 03 00 00       	call   401447 <explode_bomb> # çˆ†
  # x_2 = %ecx = 35
  4010bb:	48 8b 44 24 08       	mov    0x8(%rsp),%rax
  4010c0:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  4010c7:	00 00 
  4010c9:	75 0c                	jne    4010d7 <phase_5+0x89>
  4010cb:	48 83 c4 18          	add    $0x18,%rsp
  4010cf:	c3                   	ret    
  
  4010d0:	e8 72 03 00 00       	call   401447 <explode_bomb> # çˆ†
  4010d5:	eb a2                	jmp    401079 <phase_5+0x2b>
  4010d7:	e8 24 fa ff ff       	call   400b00 <__stack_chk_fail@plt>
```

`0x402480`å¯¹åº”çš„åœ°å€ï¼š

```assembly
                             array.3415                                   
                             
            00402480 0a              undefined10Ah                     [0]
            00402481 00              undefined100h                     [1]
            00402482 00              undefined100h                     [2]
            00402483 00              undefined100h                     [3]
            00402484 02              undefined102h                     [4]
            00402485 00              undefined100h                     [5]
            00402486 00              undefined100h                     [6]
            00402487 00              undefined100h                     [7]
            00402488 0e              undefined10Eh                     [8]
            00402489 00              undefined100h                     [9]
            0040248a 00              undefined100h                     [10]
            0040248b 00              undefined100h                     [11]
            0040248c 07              undefined107h                     [12]
            0040248d 00              undefined100h                     [13]
            0040248e 00              undefined100h                     [14]
            0040248f 00              undefined100h                     [15]
            00402490 08              undefined108h                     [16]
            00402491 00              undefined100h                     [17]
            00402492 00              undefined100h                     [18]
            00402493 00              undefined100h                     [19]
            00402494 0c              undefined10Ch                     [20]
            00402495 00              undefined100h                     [21]
            00402496 00              undefined100h                     [22]
            00402497 00              undefined100h                     [23]
            00402498 0f              undefined10Fh                     [24]
            00402499 00              undefined100h                     [25]
            0040249a 00              undefined100h                     [26]
            0040249b 00              undefined100h                     [27]
            0040249c 0b              undefined10Bh                     [28]
            0040249d 00              undefined100h                     [29]
            0040249e 00              undefined100h                     [30]
            0040249f 00              undefined100h                     [31]
            004024a0 00              undefined100h                     [32]
            004024a1 00              undefined100h                     [33]
            004024a2 00              undefined100h                     [34]
            004024a3 00              undefined100h                     [35]
            004024a4 04              undefined104h                     [36]
            004024a5 00              undefined100h                     [37]
            004024a6 00              undefined100h                     [38]
            004024a7 00              undefined100h                     [39]
            004024a8 01              undefined101h                     [40]
            004024a9 00              undefined100h                     [41]
            004024aa 00              undefined100h                     [42]
            004024ab 00              undefined100h                     [43]
            004024ac 0d              undefined10Dh                     [44]
            004024ad 00              undefined100h                     [45]
            004024ae 00              undefined100h                     [46]
            004024af 00              undefined100h                     [47]
            004024b0 03              undefined103h                     [48]
            004024b1 00              undefined100h                     [49]
            004024b2 00              undefined100h                     [50]
            004024b3 00              undefined100h                     [51]
            004024b4 09              undefined109h                     [52]
            004024b5 00              undefined100h                     [53]
            004024b6 00              undefined100h                     [54]
            004024b7 00              undefined100h                     [55]
            004024b8 06              undefined106h                     [56]
            004024b9 00              undefined100h                     [57]
            004024ba 00              undefined100h                     [58]
            004024bb 00              undefined100h                     [59]
            004024bc 05              undefined105h                     [60]
            004024bd 00              undefined100h                     [61]
            004024be 00              undefined100h                     [62]
            004024bf 00              undefined100h                     [63]
```

æ•°ç»„å…¨éƒ¨å†…å®¹ï¼š

```
0xa, 0x2, 0xe, 0x7, 0x8, 0xc, 0xf, 0xb, 0x0, 0x4, 0x1, 0xd, 0x3, 0x9, 0x6, 0x5
10 , 2 , 14 , 7 , 8 , 12 , 15 , 11 , 0 , 4 , 1 , 13 , 3 , 9 , 6 , 5
```

### phase_6

`phase_6`æœ¬ä½“ï¼š

```assembly
00000000004010dc <phase_6>:
  4010dc:	41 56                	push   %r14
  4010de:	41 55                	push   %r13
  4010e0:	41 54                	push   %r12
  4010e2:	55                   	push   %rbp
  4010e3:	53                   	push   %rbx
  4010e4:	48 83 ec 60          	sub    $0x60,%rsp
  4010e8:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax
  4010ef:	00 00 
  4010f1:	48 89 44 24 58       	mov    %rax,0x58(%rsp) # 5*16+8=88 Bytes ç•™ç©ºç»™11ä¸ªå¯„å­˜å™¨ï¼Œè¿˜æ˜¯22ä¸ªï¼Ÿ
  4010f6:	31 c0                	xor    %eax,%eax # %eax = 0
  4010f8:	48 89 e6             	mov    %rsp,%rsi # ä¸€ä¼šå„¿å¥½æŠŠå…­ä¸ªå˜é‡å­˜åˆ°æ ˆé‡Œ
  4010fb:	e8 69 03 00 00       	call   401469 <read_six_numbers>
  # è¿™å…­ä¸ªå§‘ä¸”ç®—ä½œæ•°ç»„å†… a[0], a[1], a[2] ... a[5]
  401100:	49 89 e4             	mov    %rsp,%r12 # %r12 = a åŸºå€
  401103:	49 89 e5             	mov    %rsp,%r13 # %r13 = a
  401106:	41 be 00 00 00 00    	mov    $0x0,%r14d # %r14d = 0
  40110c:	eb 25                	jmp    401133 <phase_6+0x57>                   # no.1-eax
  
  # -> no.1-compare -> no.1-loop -> no.2
  # çº¯çº¯çš„****
  
  
  40110e:	e8 34 03 00 00       	call   401447 <explode_bomb> # çˆ†
  401113:	eb 2d                	jmp    401142 <phase_6+0x66>
  
                                                                                    # no.1-ebx
  401115:	83 c3 01             	add    $0x1,%ebx  # %ebx = %ebx + 1 = 2         
  401118:	83 fb 05             	cmp    $0x5,%ebx
  40111b:	7f 12                	jg     40112f <phase_6+0x53>          # %ebx > 5ï¼Œè·³ 40112f
  # %ebx <= 5ï¼Œç›´æ¥å¾€ä¸‹èµ°ã€‚
                                                                                    # no.1-loop
  40111d:	48 63 c3             	movslq %ebx,%rax # %rax = %ebx = %r14d = 1 -> 2 -> 3
                                                                            # 2 -> 3 -> 4
  401120:	8b 04 84             	mov    (%rsp,%rax,4),%eax # %eax = a[%rax] = a[1] -> a[2]
  401123:	39 45 00             	cmp    %eax,0x0(%rbp) # %eax == a[0] åˆ™çˆ†
  401126:	75 ed                	jne    401115 <phase_6+0x39> # a[0] != a[1] -> a[2]    # no.1-ebxï¼Œå¾€ä¸Š
  # ä¹Ÿå°±æ˜¯ï¼Œåäº”ä¸ªæ•°éƒ½ä¸èƒ½ä¸ç¬¬ä¸€ä¸ªæ•°ç›¸ç­‰ï¼Ÿ
  401128:	e8 1a 03 00 00       	call   401447 <explode_bomb> # çˆ†
  40112d:	eb e6                	jmp    401115 <phase_6+0x39>
  
  # æˆ‘çŒœæµ‹ï¼Œæ˜¯è¿™å…­ä¸ªæ•°ä¸¤ä¸¤ä¹‹é—´ä¸ç›¸ç­‰
  # for(int i = 1; i <= 6; ++i)
  #		åˆ¤æ–­æ˜¯å¦å°äºç­‰äº 6 
  # 	for(int j = i + 1; j <= 5; ++j)
  # 		a[i - 1] ?= a[j]
  40112f:	49 83 c5 04          	add    $0x4,%r13 # %r13 += 4
  
                                                                                     # no.1-eax
  401133:	4c 89 ed             	mov    %r13,%rbp # %rbp = %r13 = a -> &a[1]          
  401136:	41 8b 45 00          	mov    0x0(%r13),%eax # %eax = (%r13) = a[0] -> a[1]
  40113a:	83 e8 01             	sub    $0x1,%eax # %eax = %eax - 1 = a[0]-1 -> a[1]-1
  40113d:	83 f8 05             	cmp    $0x5,%eax
  401140:	77 cc                	ja     40110e <phase_6+0x32> # %eax > 5, çˆ†
  # %eax <= 5 å³ a[0] -> a[1] <= 6
  # èƒ½ä¸èƒ½å­˜è´Ÿæ•°
  # æˆ‘ä»¬å‡å®šé‡Œå¤´çš„æ‰€æœ‰æ•°éƒ½æ˜¯1~6ï¼Œä¸å«0ã€‚
  401142:	41 83 c6 01          	add    $0x1,%r14d # %r14d = %r14d + 1 = 1 -> 2
  401146:	41 83 fe 06          	cmp    $0x6,%r14d
  40114a:	74 05                	je     401151 <phase_6+0x75> # %r14d ç­‰äº 6 åˆ™è·³ no.2
  
  40114c:	44 89 f3             	mov    %r14d,%ebx # %r14d ä¸åˆ° 6ï¼Œ%ebx = %r14d = 1 -> 2
  # å†…å¾ªç¯çš„èµ·ç‚¹ã€‚
  40114f:	eb cc                	jmp    40111d <phase_6+0x41>                   # è·³ no.1-loopï¼Œå¾€ä¸Šã€‚ 
  
  
  
  
  
  
                                                                                    # no.2
  401151:	49 8d 4c 24 18       	lea    0x18(%r12),%rcx # %r12 = a; %rcx = %r12 + 0x18 = &a[6]
  401156:	ba 07 00 00 00       	mov    $0x7,%edx # %edx = 7
  
  40115b:	89 d0                	mov    %edx,%eax # %eax = %edx = 7
  40115d:	41 2b 04 24          	sub    (%r12),%eax # %eax = %eax - (%r12) = 7 - a[0]
  401161:	41 89 04 24          	mov    %eax,(%r12) # a[0] = %eax = 7 - a[0]
  401165:	49 83 c4 04          	add    $0x4,%r12 # %r12 = %r12 + 4 = &a[1]
  401169:	4c 39 e1             	cmp    %r12,%rcx # &a[6] = %rcx ?= %r12 = &a[1]
  40116c:	75 ed                	jne    40115b <phase_6+0x7f>
  # è¦æŠŠ a[0] -> a[5] å…¨éƒ½å˜æˆ 7 - a[i]
  
  
  
  
  
  # å·²ç»éå†äº† a[0] -> a[5]
  40116e:	be 00 00 00 00       	mov    $0x0,%esi # %esi = 0
  401173:	eb 1a                	jmp    40118f <phase_6+0xb3>                    # no.3
  
  # ä¸æ˜¯ï¼Œåˆ°åº•æ˜¯ 32-bit è¿˜æ˜¯ 64-bit å•Š æˆ‘****
  
  # æ€ªä¸å¾—æ¯æ¬¡éƒ½è¦ä»$0x6032d0å¼€å§‹ï¼Œè¿™å…¶å®å°±æ˜¯éå†é“¾è¡¨çš„è¿‡ç¨‹ã€‚
  # %rdx = $0x6032d0                                     # node1
  401175:	48 8b 52 08          	mov    0x8(%rdx),%rdx                           # no.3-ecx
  # %rdx' = [%rdx + 8] = [$0x6032d8] = 0x6032e0          # node2           %ecx = 2 çš„æ—¶å€™åŒ¹é…ä¸Š
  # %rdx'' = [%rdx' + 8] = [$0x6032e8] = 0x6032f0        # node3           %ecx = 3 çš„æ—¶å€™åŒ¹é…ä¸Š
  # %rdx''' = [%rdx'' + 8] = [$0x6032f8] = 0x603300      # node4           %ecx = 4 çš„æ—¶å€™åŒ¹é…ä¸Š
  # %rdx'''' = [%rdx''' + 8] = [$0x603308] = 0x603310    # node5           %ecx = 5 çš„æ—¶å€™åŒ¹é…ä¸Š
  # %rdx''''' = [%rdx'''' + 8] = [$0x603318] = 0x603320  # node6           %ecx = 6 çš„æ—¶å€™åŒ¹é…ä¸Š
  # %rdx'''''' = [%rdx''''' + 8] = [$0x603328] = 0
  401179:	83 c0 01             	add    $0x1,%eax # %eax = %eax + 1 = 2;
  40117c:	39 c8                	cmp    %ecx,%eax # %eax ?= %ecx = a[0]
  40117e:	75 f5                	jne    401175 <phase_6+0x99>
  # %eax = 2, 3, 4, 5
  
  # %ecx = %eax åŒ¹é…ä¸Šäº†                                           # a[8], a[10], ... , a[18] 
  401180:	48 89 54 f4 20       	mov    %rdx,0x20(%rsp,%rsi,8) # a[2*%rsi + 32/4] = a[2*%rsi + 8] = %rdx
  # è¿˜æ˜¯ a[%rsi + 4] = %rdx
  # a'[4] ... a'[9]ï¼Œå“¦ï¼Œå…¶å®è¿™ä¸ªæ˜¯ç›¸å½“äºæŠŠåŸæœ¬çš„ a[0], ..., a[5] æ”¾åœ¨äº†å‰ä¸‰ä¸ªå…±24å­—èŠ‚å†…ï¼Œä¹‹åçš„æ–°çš„a'[4], ... ,a'[9]æ˜¯8å­—èŠ‚çš„
  # å°½ç®¡å¦‚æ­¤ï¼Œå‰é¢çš„è¯¸å¦‚ 0x6032e0 æ­¤å¤„ä»å‡å®šä¸ºåªæ˜¯32ä½çš„ï¼ˆé«˜32ä½ä¸º 0ï¼‰ã€‚
  # ç›¸å½“äºæŠŠ node çš„åœ°å€å­˜åˆ°äº†æ•°ç»„é‡Œï¼Œa'[4] ... a'[9]çš„å…ˆåé¡ºåºæ˜¯ä¸a[0], a[1], ... , a[5] çš„é¡ºåºä¸€è‡´çš„ã€‚
  # å¤§èƒ†çŒœæµ‹ï¼Œa[0], a[1], ... , a[5]çš„å…ƒç´ æ ‡è®°çš„æ˜¯åœ¨é“¾è¡¨ä¸­çš„â€œä½ç½®â€ã€‚ï¼ˆç¬¬a[0]ä¸ªã€ç¬¬a[1]ä¸ªâ€¦â€¦ï¼Œå¯¹åº”a'[4], ... , a'[9]é‡Œå„è‡ªå­˜çš„ node åœ°å€ï¼‰
  401185:	48 83 c6 01          	add    $0x1,%rsi # %rsi = %rsi + 1
  401189:	48 83 fe 06          	cmp    $0x6,%rsi # %rsi ?= 6
  40118d:	74 14                	je     4011a3 <phase_6+0xc7>                     # no.4
  # ç›´åˆ° 6 ä¸ªéƒ½åŒ¹é…å®Œ
  # a[8], a[10], ... , a[18] 
  # a[4] ... a[9] è¿™ä¸ªçœ‹ç€æ›´é¡ºçœ¼
  40118f:	8b 0c b4             	mov    (%rsp,%rsi,4),%ecx # %ecx=a[%rsi]=a[0]    # no.3
  401192:	b8 01 00 00 00       	mov    $0x1,%eax # %eax = 1
  401197:	ba d0 32 60 00       	mov    $0x6032d0,%edx # ä¹‹åä¼šæœ‰ (%edx) = 0x00027aï¼Œç«‹å³æ•°çš„ mov
                                    #  0x6032d0          # node1
  40119c:	83 f9 01             	cmp    $0x1,%ecx # %ecx = a[0] ?= 1
  40119f:	7f d4                	jg     401175 <phase_6+0x99> # %ecx > 1           # no.3-ecxï¼Œå¾€ä¸Š
  # %ecx <= 1
  # åˆ°åº•èƒ½ä¸èƒ½ç­‰äº 0 å•Šè¯è¯´æˆ‘****
  4011a1:	eb dd                	jmp    401180 <phase_6+0xa4>
  
  
  
  
  
  
  
  # æˆ‘ä»¬è¯»å…¥çš„æ˜¯å„ä¸ªå…ƒç´ åœ¨é“¾è¡¨ä¸­çš„ä½ç½®a[0], a[1], a[2], ... , a[5] (0<=i<=5, 1<=a[i]<=6)
  # æˆ‘ä»¬æ–°å¼€äº†ä¸€ä¸ªæ•°ç»„a'[4], a'[5], a'[6], ... , a'[9]ï¼ˆå­˜æ”¾ç€ä¸Šè¾¹é‚£äº›ä½ç½®å¯¹åº”çš„é“¾è¡¨ node åœ°å€ï¼‰
  # é“¾è¡¨ node çš„å„åœ°å€å­˜å‚¨çš„æ˜¯ï¼Œå½“å‰ node æŒ‡å‘çš„ä¸‹ä¸€ node çš„åœ°å€ã€‚
  # å¯¹äºåœ°å€ï¼Œæˆ‘ä»¬é‡‡ç”¨&a[i]å’Œa[i]ä»¥åŠa[i]->vçš„æ–¹å¼æ¥åŒºåˆ†ã€‚
  # åœ°å€é‡Œå¥—åœ°å€ï¼Œå¥½æ­¹æ¯’å•Šï¼Œæˆ‘****ã€‚
                                                                                      # no.4
  4011a3:	48 8b 5c 24 20       	mov    0x20(%rsp),%rbx # %rbx = a'[4] å­˜æ”¾çš„æ˜¯ a'[4] çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ node åœ°å€
  4011a8:	48 8b 44 24 28       	mov    0x28(%rsp),%rax # %rax = a'[5] å­˜æ”¾çš„æ˜¯ a'[5] çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ node åœ°å€
  # è¦å°† %rax æ”¾åˆ° %rbx + 0x8 è¿™ä¸€åœ°å€çš„å†…å­˜ä¸­ã€‚
  4011ad:	48 89 43 08          	mov    %rax,0x8(%rbx)  # (%rbx + 8) = %rax å³ [a'[4] + 8]->v = a'[5]
                                    # [a'[4] + 8] æŒ‡çš„æ˜¯ â€œa'[4] å­˜çš„åœ°å€ç‰©ç†ä¸Šç›¸é‚»ä¸‹ä¸€ä¸ª node çš„å€¼â€
                                    # ä¸ºä»€ä¹ˆè¦ç»™å®ƒèµ‹å€¼æˆè¿™æ ·ï¼Ÿ
  4011b1:	48 8b 54 24 30       	mov    0x30(%rsp),%rdx # %rdx = a'[6]
  4011b6:	48 89 50 08          	mov    %rdx,0x8(%rax)  # (%rax + 8) = %rdx å³ [a'[5] + 8]->v = a'[6]
  4011ba:	48 8b 44 24 38       	mov    0x38(%rsp),%rax # %rax = a'[7]
  4011bf:	48 89 42 08          	mov    %rax,0x8(%rdx)  # (%rdx + 8) = %rax å³ [a'[6] + 8]->v = a'[7]
  4011c3:	48 8b 54 24 40       	mov    0x40(%rsp),%rdx # %rdx = a'[8]
  4011c8:	48 89 50 08          	mov    %rdx,0x8(%rax)  # (%rax + 8) = %rdx å³ [a'[7] + 8]->v = a'[8]
  4011cc:	48 8b 44 24 48       	mov    0x48(%rsp),%rax # %rax = a'[9]
  4011d1:	48 89 42 08          	mov    %rax,0x8(%rdx)  # (%rdx + 8) = %rax å³ [a'[8] + 8]->v = a'[9]
  4011d5:	48 c7 40 08 00 00 00 	movq   $0x0,0x8(%rax)  # [a'[9] + 8]->v = 0
  4011dc:	00 
  4011dd:	bd 05 00 00 00       	mov    $0x5,%ebp # %ebp = 5
  4011e2:	eb 09                	jmp    4011ed <phase_6+0x111>                 # 4011ed
  
  
  # (%rbx) >= %eax
                                                                                   # 4011e4
  4011e4:	48 8b 5b 08          	mov    0x8(%rbx),%rbx # %rbx = (%rbx + 8) = [a'[4] + 8]->v = a'[5]
  4011e8:	83 ed 01             	sub    $0x1,%ebp # %ebp --;
  4011eb:	74 11                	je     4011fe <phase_6+0x122> # %ebp == 0
  # %ebp = 1
                                                                                   # 4011ed
  4011ed:	48 8b 43 08          	mov    0x8(%rbx),%rax # %rax = (%rbx + 8) = [a'[4] + 8]->v = a'[5]
                                                          # %rax = (%rbx + 8) = [a'[5] + 8]->v = a'[6]
                                                          # %rax = (%rbx + 8) = [a'[6] + 8]->v = a'[7]
                                                          # %rax = (%rbx + 8) = [a'[7] + 8]->v = a'[8]
                                                          # %rax = (%rbx + 8) = [a'[8] + 8]->v = a'[9]
  4011f1:	8b 00                	mov    (%rax),%eax # %eax = (%rax) = a'[5]->v
                                                        # %eax = (%rax) = a'[6]->v
                                                        # %eax = (%rax) = a'[7]->v                                                                                         # %eax = (%rax) = a'[8]->v
                                                        # %eax = (%rax) = a'[9]->v
                                                        
  # è¿™å°±æ˜¯ä¸ºä»€ä¹ˆnodeæœ‰16å­—èŠ‚ï¼Œè€Œä¹‹å‰åªæ˜¯ä¸€ç›´åœ¨ç”¨é«˜8å­—èŠ‚ï¼Ÿ
  4011f3:	39 03                	cmp    %eax,(%rbx) # [a'[4]]->v >= %eax = a'[5]->v
                                                       # [a'[5]]->v >= %eax = a'[6]->v
                                                       # [a'[6]]->v >= %eax = a'[7]->v
                                                       # [a'[7]]->v >= %eax = a'[8]->v
                                                       # [a'[8]]->v >= %eax = a'[9]->v
  4011f5:	7d ed                	jge    4011e4 <phase_6+0x108> # (%rbx) >= %eax # 4011e4ï¼Œå¾€ä¸Šã€‚
  # å¿…é¡»æ˜¯é™åº
  
  4011f7:	e8 4b 02 00 00       	call   401447 <explode_bomb> # çˆ†
  
  4011fc:	eb e6                	jmp    4011e4 <phase_6+0x108>
  
  4011fe:	48 8b 44 24 58       	mov    0x58(%rsp),%rax
  401203:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax
  40120a:	00 00 
  40120c:	75 0d                	jne    40121b <phase_6+0x13f> # çˆ†æ ˆ
  40120e:	48 83 c4 60          	add    $0x60,%rsp
  401212:	5b                   	pop    %rbx
  401213:	5d                   	pop    %rbp
  401214:	41 5c                	pop    %r12
  401216:	41 5d                	pop    %r13
  401218:	41 5e                	pop    %r14
  40121a:	c3                   	ret    
  40121b:	e8 e0 f8 ff ff       	call   400b00 <__stack_chk_fail@plt>
```

ä¸€ç›´ä¹Ÿæ²¡æœ‰ææ‡‚åˆ°åº•`call   401447 <explode_bomb>`å®Œåç´§è·Ÿç€è¿˜è¦æ‰§è¡Œçš„ä»£ç æ®µæ˜¯ä»€ä¹ˆæ„æ€ã€‚

```assembly
                       node1                                                             
  006032d0  7a 02 00 00                 undefined4          0000027Ah
  006032d4  01                          ??                  01h
  006032d5  00                          ??                  00h
  006032d6  00                          ??                  00h
  006032d7  00                          ??                  00h
                       PTR_node2_006032d8                                               
  006032d8  e0 32 60 00 00 00           addr                node2
            00 00
                       node2[8]                                                         
                       node2                                                             
  006032e0  53 03 00 00 02 00           undefined1[16]
            00 00 f0 32 60 00 
            00 00 00 00
                       node3                                                             
  006032f0  99 03 00 00 03 00           undefined1[16]
            00 00 00 33 60 00 
            00 00 00 00
                       node4                                                             
  00603300  36 01 00 00 04 00           undefined1[16]
            00 00 10 33 60 00 
            00 00 00 00
                       node5                                                             
  00603310  49 02 00 00 05 00           undefined1[16]
            00 00 20 33 60 00 
            00 00 00 00
                       node6                                                             
  00603320  8a 00 00 00 06 00           undefined1[16]
            00 00 00 00 00 00 
            00 00 00 00

```

è¢«å‘å®³äº†ï¼Œ`node1`é‡Œçš„`undefined4`åº”è¯¥ï¼ˆï¼Ÿï¼‰æ˜¯è§„å®šäº†ä¸€ä¸ª 4 Bytes çš„å€¼ï¼Œä¹‹åé‚£ä¸ª`PTR_node2_006032d8`æ˜¯æ˜ç¡®åœ°è¡¨ç¤ºå‡ºäº†8å­—èŠ‚çš„æŒ‡é’ˆï¼Œä¸­é—´éƒ¨åˆ†çœ‹ä¸Šå»æ˜¯ä¸€ä¸ªç´¢å¼•ï¼Œé—®é¢˜å¾ˆå¤§ç¨‹åº¦ä¸Šå‡ºç°åœ¨äº†æˆ‘ä¹‹å‰ä»¥ä¸ºå‰8ä¸ªå­—èŠ‚éƒ½æ˜¯è¡¨ç¤ºç€ä¸€ä¸ª64ä½çš„æ•´æ•°ã€‚

```c
struct Node {
    int value;          // èŠ‚ç‚¹å€¼
    int index;          // çŒœæµ‹ä¸­é—´éƒ¨åˆ†æ˜¯ä¸€ä¸ªç´¢å¼•ï¼ˆå› ä¸ºéƒ½æ˜¯01, 02, 03, ..., 06è¿™ç§çš„ï¼‰
    struct Node* next;  // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
};
```

è¿™ä¸‹ç»ˆäºæœ‰å¤´ç»ªäº†ï¼š

```python
# æ ¹æ®å°ç«¯åºæ’åˆ—ï¼Œå°†ç»™å®šçš„èŠ‚ç‚¹ä¸­çš„4å­—èŠ‚æ•´æ•°å€¼æå–å‡ºæ¥
# æ¯ä¸ªèŠ‚ç‚¹çš„èµ·å§‹4å­—èŠ‚æŒ‰å°ç«¯åºå­˜å‚¨æ•´æ•°å€¼

# å®šä¹‰æ¯ä¸ªèŠ‚ç‚¹èµ·å§‹çš„4å­—èŠ‚æ•°æ®
nodes_bytes = {
    "node1": [0x7a, 0x02, 0x00, 0x00],  # 0x0000027a
    "node2": [0x53, 0x03, 0x00, 0x00],  # 0x00000353
    "node3": [0x99, 0x03, 0x00, 0x00],  # 0x00000399
    "node4": [0x36, 0x01, 0x00, 0x00],  # 0x00000136
    "node5": [0x49, 0x02, 0x00, 0x00],  # 0x00000249
    "node6": [0x8a, 0x00, 0x00, 0x00],  # 0x0000008a
}

# æå–æ¯ä¸ªèŠ‚ç‚¹çš„æ•´æ•°å€¼
node_values = {node: int.from_bytes(bytes_list, "little") for node, bytes_list in nodes_bytes.items()}

node_values

```

æå–å‡ºæ¥çš„ç»“æœï¼š

```json
{'node1': 634,
 'node2': 851,
 'node3': 921,
 'node4': 310,
 'node5': 585,
 'node6': 138}
```

```C
3 2 1 5 4 6 // 7-a[i]
4 5 6 2 3 1 // 7-a[i]
```



## å››ã€å®éªŒæ€»ç»“

### x86ä¸­çš„32ä½å’Œ64ä½å¯„å­˜å™¨

Yes, of course. It is the same register, no matter if you address it using 8/16/32/64 bit mode.

https://stackoverflow.com/questions/43623012/do-32-and-64-bit-values-share-the-same-register-space

```assembly
|63..32|31..16|15-8|7-0|
               |AH.|AL.|
               |AX.....|
       |EAX............|
|RAX...................|
```

https://stackoverflow.com/questions/228200/why-is-there-not-a-register-that-contains-the-higher-bytes-of-eax/228367#228367

https://stackoverflow.com/questions/11177137/why-do-x86-64-instructions-on-32-bit-registers-zero-the-upper-part-of-the-full-6

### `test %eax, %eax`

`test eax,eax` is just an optimized `cmp eax,0`. It's written this way to save space, as `cmp eax,0` must encode that zero directly into your program as `00 00 00 00` (yes, that's 4 bytes that are each zero), which wastes space doing the same thing to the zero flag that `test eax, eax` does.

https://stackoverflow.com/questions/75075395/contradictory-behavior-of-jne-x86-assembly-instruction

https://stackoverflow.com/questions/147173/testl-eax-against-eax

https://reverseengineering.stackexchange.com/questions/15184/what-does-the-test-instruction-do

### `rep ret`

https://stackoverflow.com/questions/20526361/what-does-rep-ret-mean

### C String

https://stackoverflow.com/questions/6282198/reading-string-from-input-with-space-character

https://stackoverflow.com/questions/1247989/how-do-you-allow-spaces-to-be-entered-using-scanf

### C Char

**å¤§å—éœ‡æ’¼**

In C, the type of a character *constant* like `'a'` is actually an `int`, with size of 4 (or some other implementation-dependent value). In C++, the type is `char`, with size of 1. This is one of many small differences between the two languages.

https://stackoverflow.com/questions/2172943/why-is-the-size-of-a-character-sizeofa-different-in-c-and-c

In C++, `sizeof('a') == sizeof(char) == 1`. This makes intuitive sense, since `'a'` is a character literal, and `sizeof(char) == 1` as defined by the standard.

In C however, `sizeof('a') == sizeof(int)`. That is, it  appears that C character literals are actually integers. Does anyone  know why? I can find plenty of mentions of this C quirk but no  explanation for why it exists.

https://stackoverflow.com/questions/433895/why-are-c-character-literals-ints-instead-of-chars

### Byte & Word Addressing

https://stackoverflow.com/questions/48129466/why-do-we-use-byte-addressing-instead-of-word-addressing

### `js` instruction

`JS` will jump if the sign flag is set (by an earlier instruction). [CMP](http://web.itu.edu.tr/~aydineb/index_files/instr/cmp.html) will always modify the flags by performing a subtraction, in this case `%cl - %al`.

`CMP`: **Subtracts source from destination.**

https://stackoverflow.com/questions/21872334/what-does-js-do-in-assembly-x86

éå¸¸å¥½ç¼©å†™ã€æœ‰/æ— ç¬¦å·ã€‚

http://www.unixwiz.net/techtips/x86-jumps.html

### `FS` segment register

https://stackoverflow.com/questions/10810203/what-is-the-fs-gs-register-intended-for

The x86 architecture supports segmentation. Instructions which access memory can use segment register based addressing mode. The following notation is used to address a byte within a segment:

> Segment-register:Byte-address

The segment base address is added to the Byte-address to compute the resulting virtual address which is accessed. This allows to access multiple instances of data with the identical Byte-address, i.e. the same code. The selection of a particular instance is purely based on the base-address in the segment register.

The FS segment is commonly used to address Thread Local Storage (TLS). FS is usually managed by runtime code or a threading library. Variables declared with the â€˜__threadâ€™ storage class specifier are instantiated per thread and the compiler emits the FS: address prefix for accesses to these variables. Each thread has its own FS base address so common code can be used without complex address offset calculations to access the per thread instances. Applications should not use FS for other purposes when they use runtimes or threading libraries which manage the per thread FS.

https://www.kernel.org/doc/html/next/x86/x86_64/fsgs.html

### `JLE` instruction

https://stackoverflow.com/questions/9617877/assembly-jg-jnle-jl-jnge-after-cmp

### `LEA` instruction

ä¹Ÿåªæœ‰åœ¨`LEA`æŒ‡ä»¤ä¸‹ï¼Œ`offset(base, index, multiplier)`æ‰ä¼šè¢«è§†ä½œæ‰€æŒ‡å‘çš„åœ°å€ï¼Œè€Œéå…¶åœ°å€æ‰€æŒ‡å‘çš„å†…å®¹ã€‚

éå¸¸èµåŒï¼š

Wouldn't it have been cleaner to extend the `mov` instruction and leave off the brackets? `MOV EDX, EBX + 8*EAX + 4`

By replacing LEA with a specialized MOV you  keep the syntax clean: [] brackets are always the equivalent of  dereferencing a pointer in C. Without brackets, you always deal with the pointer itself.

https://stackoverflow.com/questions/1658294/whats-the-purpose-of-the-lea-instruction

### `__isoc99_sscanf`

**This  function  return the number of input items successfully matched and assigned, which can be fewer than provided for, or even zero in the event of an early matching failure.**

https://stackoverflow.com/questions/69829654/what-does-isoc99-sscanf-do

https://stackoverflow.com/questions/56444576/asm-isoc99-scanf-after-function-declaration

On x86_64, parameters are passed in registers, so your call to scanf has 3 parameters stored in 3 registers:

- `rdi` pointer to the string `"%u %u"`, the format to parse (two unsigned integers)
- `rsi` should be a `unsigned *`, pointer to where to put the first parsed integer
- `rdx` pointer to where to put the second parsed integer.

https://stackoverflow.com/questions/72492532/in-which-register-does-the-scanf-function-store-input-values

### "address" of a register

https://stackoverflow.com/questions/5301292/is-there-is-a-way-to-get-the-address-of-a-register

https://stackoverflow.com/questions/52308185/are-cpu-general-purpose-registers-usually-memory-mapped

### indirect addressing

```assembly
movl (%edx), %eax
```

Means "the memory at the address that's stored in the register". 

https://stackoverflow.com/questions/61004313/what-do-parentheses-surrounding-a-register-mean

https://stackoverflow.com/questions/69967899/indirect-adressing-in-assembly-x86

https://stackoverflow.com/questions/46123822/how-to-load-the-contents-of-the-memory-address-stored-in-a-register-in-assembly       

The complete AT&T base/index register syntax is:

```assembly
offset(base, index, multiplier)
```

https://stackoverflow.com/questions/18650093/what-does-a-comma-in-a-parenthesis-mean-in-the-att-syntax-for-x86-assembly

```assembly
GAS memory operand      NASM memory operand
------------------      -------------------

100                     [100]
%es:100                 [es:100]
(%eax)                  [eax]
(%eax,%ebx)             [eax+ebx]
(%ecx,%ebx,2)           [ecx+ebx*2]
(,%ebx,2)               [ebx*2]
-10(%eax)               [eax-10]
%ds:-10(%ebp)           [ds:ebp-10]
Example instructions,
mov %ax,    100
mov %eax,   -100(%eax)
```

https://stackoverflow.com/questions/6819957/what-does-the-bracket-in-movl-eax-eax-mean/6820015#6820015

https://stackoverflow.com/questions/27936196/a-couple-of-questions-about-base-indexscale-disp-and-att-dispbase-inde

### `%al` register

- **`EAX` is the full 32-bit value**
- **`AX` is the lower 16-bits**
- **`AL` is the lower 8 bits**
- **`AH` is the bits 8 through 15** (zero-based), the top half of AX

### Parentheses

- åœ¨ `lea 0x4(%rsi), %rcx` æŒ‡ä»¤ä¸­ï¼Œ`lea`ï¼ˆLoad Effective Addressï¼‰çš„ä½œç”¨æ˜¯è®¡ç®—æ‹¬å·å†…ç»™å‡ºçš„åœ°å€è¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶å°†è¿™ä¸ªè®¡ç®—ç»“æœï¼ˆå³åœ°å€ï¼‰åŠ è½½åˆ° `%rcx` å¯„å­˜å™¨ä¸­ã€‚è¿™é‡Œï¼Œæ‹¬å·å†…çš„è¡¨è¾¾å¼ `0x4(%rsi)` è¡¨ç¤º `%rsi` å¯„å­˜å™¨çš„å€¼åŠ ä¸Š 4ï¼Œè¿™ä¸ªç»“æœæ˜¯ä¸€ä¸ªåœ°å€ï¼Œè¢«ç›´æ¥å­˜å‚¨åœ¨ `%rcx` ä¸­ï¼Œä¸è¿›è¡Œå†…å­˜è®¿é—®ã€‚

- åœ¨ `movq 8(%rbp), %rdx` æŒ‡ä»¤ä¸­ï¼Œ`movq` æ˜¯æ•°æ®ä¼ é€æŒ‡ä»¤ï¼Œç”¨äºå°†æ•°æ®ä»æºä½ç½®ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®ã€‚è¿™é‡Œçš„æ‹¬å· `8(%rbp)` è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œè®¡ç®—æ–¹å¼æ˜¯ `%rbp` å¯„å­˜å™¨çš„å€¼åŠ ä¸Š 8ã€‚ä¸ `lea` æŒ‡ä»¤ä¸åŒï¼Œ`movq` ä¼šè®¿é—®è¯¥åœ°å€æŒ‡å‘çš„å†…å­˜ä½ç½®ï¼Œå°†é‚£é‡Œçš„æ•°æ®ï¼ˆ64ä½æˆ–è€…8å­—èŠ‚ï¼Œå› ä¸ºæ˜¯ `movq`ï¼‰åŠ è½½åˆ° `%rdx` å¯„å­˜å™¨ä¸­ã€‚

å› æ­¤ï¼Œ`lea` æŒ‡ä»¤çš„æ‹¬å·ç”¨äºæ„é€ åœ°å€è¡¨è¾¾å¼ï¼Œç»“æœæ˜¯ä¸€ä¸ªåœ°å€ï¼Œè€Œ `movq` æŒ‡ä»¤çš„æ‹¬å·ç”¨äºæŒ‡å®šä¸€ä¸ªå†…å­˜åœ°å€ï¼ŒæŒ‡ä»¤ä¼šè®¿é—®è¯¥åœ°å€å¹¶åŠ è½½æˆ–å­˜å‚¨æ•°æ®ã€‚ç®€å•æ¥è¯´ï¼Œ`lea` ä¸åœ°å€è®¡ç®—ç›¸å…³ï¼Œè€Œ `movq` ä¸å®é™…çš„å†…å­˜è®¿é—®æ“ä½œç›¸å…³ã€‚**âš ï¸ ChatGPT 4 ç”Ÿæˆï¼ˆå…¶æªè¾å¯èƒ½ä¼šè®©äººç–‘æƒ‘ï¼‰**

### end of array

C arrays don't have an end marker.

It is your responsibility as the programmer to keep track of the  allocated size of the array to make sure you don't try to access element outside the allocated size.

If you do access an element outside the allocated size, the result is [undefined behaviour](https://en.wikipedia.org/wiki/Undefined_behavior).

https://stackoverflow.com/questions/53579155/end-of-array-in-c-language

### Silver Bullet of NSA

**Ghidra** (pronounced GEE-druh; [/ËˆÉ¡iËdrÉ™/](https://en.wikipedia.org/wiki/Help:IPA/English) )

https://ghidra-sre.org/

### Asterisk

The line

```
jmpq   *0x402680(,%rax,8)
```

would be described in RTN by:

```
RIP <- M[0x402680 + (8 * RAX)]
```

where `M` is the system memory.

As such, we can write the general form `jmpq *c(r1, r2, k)`, where `c` is an immediate constant, `r1` and `r2` are general purpose registers and `k` is either 1 (default), 2, 4 or 8:

```
RIP <- M[c + r1 + (k * r2)]
```

https://stackoverflow.com/questions/9223756/what-does-an-asterisk-before-an-address-mean-in-x86-64-att-assembly

### Intel Little Endian

https://stackoverflow.com/questions/6018386/is-x86-64-machine-language-big-endian

### `__stack_chk_fail`

The interface `__stack_chk_fail()` shall abort the function that called it with a message that a stack overflow has been detected. The program that called the function shall then exit.

The interface `__stack_chk_fail()` does not check for a stack overflow itself. It merely reports one when invoked.

http://refspecs.linux-foundation.org/LSB_4.1.0/LSB-Core-generic/LSB-Core-generic/libc---stack-chk-fail-1.html

### `shr` & `sar`instruction

- The `shr` or `sar` instruction is used to shift  the bits of the operand destination to the right, by the number of bits  specified in the count operand.
- Bits shifted beyond the destination are first shifted into the [CF flag](https://www.aldeid.com/wiki/X86-assembly/Registers#CF_.28Carry_Flag.29).
- Equivalent to dividing by 2

```
mov eax, 0xA  ; set EAX to 0xA (1010 in binary)
shr eax, 2    ; shifts 2 bits to the right in EAX, now equal to 0x2 (0010 in binary)
              +---+---+---+---+---â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
mov eax, 0xA  | 0 | 0 | 0 | 0 | 0 â”‚ 1 â”‚ 0 â”‚ 1 â”‚ 0 â”‚
              +---+---+---+---+---â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
                                    â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”       â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
              +---+---+---+---+---+---+---â”¬â”€â”€â”€â”¬â”€â”€â”€â”   â”Œâ”€â”€â”€â”
shr eax, 2    | 0 | 0 | 0 | 0 | 0 | 0 | 0 â”‚ 1 â”‚ 0 â”‚   â”‚ 1 â”‚
              +---+---+---+---+---+---+---â”´â”€â”€â”€â”´â”€â”€â”€â”˜   â””â”€â”€â”€â”˜
                                                        CF
```

https://www.aldeid.com/wiki/X86-assembly/Instructions/shr

| Opcode  | Mnemonic      | Description                          |
| ------- | ------------- | ------------------------------------ |
| `D2 /5` | `SHR r/m8,CL` | Unsigned divide r/m8 by 2, CL times. |
| `D2 /7` | `SAR r/m8,CL` | Signed divide* r/m8 by 2, CL times.  |

https://c9x.me/x86/html/file_module_x86_id_285.html

> if you perform `SHR` 00110000b you would end up with 00011000b

If you shifted one bit to the right, yes. You can specify the shift amount, so it's not fixed at 1.

> However, if you were to perform `SHR` on 11111111b you would end up with an incorrect answer 

If you did a logical shift of 11111111b one bit to the right you'd  get 01111111b. Whether you consider that to be incorrect or not depends  entirely on what you're trying to achieve. If you wanted to preserve the sign you should've used `SAR`.

https://stackoverflow.com/questions/30644708/shr-and-sar-commands

### `strtol`

Interprets an integer value in a byte string pointed to by `str`.

If successful, an integer value corresponding to the contents of `str` is returned.

https://en.cppreference.com/w/c/string/byte/strtol

### `cltq`

- Convert Long To Quad (`cltq`): AT&T-style
- quad (aka quad-word) == 8 bytes
- long (AT&T) == double-word (Intel) == 4 bytes

It sign extends `%eax` from 4 bytes into 8 bytes.

https://stackoverflow.com/questions/6555094/what-does-cltq-do-in-assembly